!function(e){"use strict";const{abs:t,acos:a,asin:r,atan:n,atan2:i,ceil:l,cos:o,exp:s,floor:y,log:h,hypot:c,max:u,min:x,pow:p,random:f,round:g,sin:d,sqrt:v,tan:w,PI:m}=Math;async function b(e,{minSize:t=1e3,maxSize:a=5e3,filter:r="",scale:n=1,stripWhite:i=!0,crop:o=!0,canvas:s=null,brightness:h=1,contrast:c=1,invert:p=!1,blur:f=0}={}){let g,d,v=function(e){if(e instanceof HTMLImageElement)return"img";if(e instanceof SVGElement)return"svg";if(e instanceof HTMLCanvasElement)return"canvas";if(e instanceof File)return"file";if(e instanceof ArrayBuffer)return"buffer";if(e instanceof Blob)return"blob";if(Array.isArray(e))return"array";if("string"==typeof e){let t=/^(file:|https?:\/\/|\/|\.\/|\.\.\/)/.test(e),a=e.startsWith("data:image");return t||a?"url":"string"}let t=typeof e,a=e.constructor.name;return(a||t).toLowerCase()}(e),w={minSize:t,maxSize:a,filter:r,scale:n,brightness:h,contrast:c,invert:p,blur:f,canvas:s};if("img"===v)d=e.src,g=await A(d,w);else if("blob"===v||"file"===v)d=await URL.createObjectURL(e),g=await A(d,w);else if("url"===v)d=e,console.log("is URL",e),g=await A(d,w);else if("svg"===v)d=await S(e),g=await A(d,w);else if("canvas"===v){let t=e.getContext("2d"),a=`grayscale(1) invert(${p=p?"1":"0"}) blur(${f}px) brightness(${h}) contrast(${c})`;t.filter=a;let r=await t.getImageData(0,0,e.width,e.height);g={imgData:r,width:r.width,height:r.height,scaleAdjust:1}}let{imgData:m,scaleAdjust:b,width:$,height:L}=g,D={x:0,y:0,width:0,height:0};o&&(D=function(e,t=!0,a=!0,r=!1,n=null){let[i,l]=[e.width,e.height];if(!i&&!l)throw new Error("No width or height specified");let o,s=[],h={x:0,y:0,width:i,height:l},c=new Uint32Array(e.data.buffer),p=0,f="";const g=(e,t,a)=>{let r=y(a/e);return{x:a-r*e,y:r}},d=(e=0,t=!1,a=null)=>{if(r&&a){p++;let e=g(i,0,a);f+=`<rect x="${e.x}" y="${e.y}" transform="scale(1)" transform-origin="center" width="1" height="1" fill="rgba(0,255,255,0.25)" stroke="none" />`}return t?e<4294867295:e>0};let v=0,w=0,m=0,b=0,A=i,$=l,S=0,z=i*l-1,[L,D,R,j]=[1,1,1,1];if(a){let e=y(i/2),a=y(l/2),n=[0,l*i-1,i-1,l*i-i,e,l*i-e-1,a*i-1,a*i];for(let e=0;e<n.length;e++){let a=n[e];if(!(L||j||D||R))break;d(c[a],t,a)&&(0===e?(L=0,D=0):1===e?(j=0,R=0):2===e?(j=0,D=0):3===e?(L=0,D=0):4===e?L=0:5===e?j=0:6===e?R=0:7===e&&(D=0))}if(r&&console.log("corner mid check",p,"cropTop",L,"cropLeft",D,"cropRight",R,"cropBottom",j),!(L||D||R||j))return r&&console.log("image cannot be cropped â€“ opaque pixels in corners",p,"cropTop",L,"cropLeft",D,"cropRight",R,"cropBottom",j),h}for(w=0;w<l;w++){for(v=0;v<i&&(!L||!d(c[S],t,S)||(m=w,L=0,s.push(v),j))&&(!j||!d(c[z],t,z)||($=l-w,j=0,o=g(i,0,z),s.push(o.x),L));v++)S++,z--;if(!L&&!j)break;if(w+2>=l-w&&!m)return r&&(console.log("image is empty",w,p,i*l),n.insertAdjacentHTML("beforeend",f)),h}for(v=0;v<i;v++)for(S=(m+1)*i+v,z=m*i+(i-v-1),w=m;w<$-1&&(!D||!d(c[S],t,S)||(b=v,D=0,R))&&(!R||!d(c[z],t,z)||(A=i-v,R=0,D));w++)S+=i,z+=i;return b=x(...s,b),A=u(...s,A),h.x=b,h.y=m,h.width=A-b,h.height=$-m,r&&(console.log(p,i*l,"skipped:",i*l-p,s),n.insertAdjacentHTML("beforeend",f)),h}(m,i),$=l(D.width/b),L=l(D.height/b),g.width=$,g.height=L);let R=function(e,t=0,a=0,r=0,n=0){let{data:i,width:l,height:o}=e;r=r||l,n=n||o;let s=new z(r,n),y=4*l,h=0;for(let e=a;e<a+n;e++){let a=0,n=e*y;for(let e=t;e<t+r;e++){let t=i[n+4*e],l=h*r+a;s.data[l]=t<127?1:0,a++}h++}return s}(m,D.x,D.y,D.width,D.height);return{bmp:R,scaleAdjust:b,width:$,height:L}}async function A(e="",{minSize:t=1e3,maxSize:a=5e3,scale:r=1,brightness:n=1,contrast:i=1,invert:o=0,blur:s=0,canvas:y=null}={}){let h,c,u,p,f=1,g=0;t*=r,a*=r,y||((y=document.getElementById("canvasPot"))||(y=document.createElement("canvas")),y.id="canvasPot",document.body.append(y));let d,v=y.getContext("2d",{alpha:!1,willReadFrequently:!0}),w=await fetch(e);if(w.ok){let r=await w.blob(),{type:l}=r;"image/svg+xml"!==l?(d=!0,h=await createImageBitmap(r),[c,u]=[h.width,h.height]):(h=new Image,h.src=e,h.crossOrigin="anonymous",await h.decode(),[c,u]=[h.naturalWidth,h.naturalHeight]),g=x(c,u),f=!d&&(g<t||g>a)?t/g:1,c*=f,u*=f,y.width=c,y.height=u,v.fillStyle="white",v.fillRect(0,0,c,u);let m=`grayscale(1) invert(${o=o?"1":"0"}) blur(${s}px) brightness(${n}) contrast(${i})`;v.filter=m,v.drawImage(h,0,0,c,u),p=v.getImageData(0,0,c,u)}let{width:m,height:b}=p;return m=l(m/f),b=l(b/f),{imgData:p,scaleAdjust:f,width:m,height:b}}async function $(e,{minSize:t=1e3,maxSize:a=5e3,filter:r="",scale:n=1,canvas:i=null}={}){i||(i=document.createElement("canvas"));let l=await S(e),o=new Image;o.src=l,o.crossOrigin="anonymous",await o.decode();let[s,y]=[o.naturalWidth,o.naturalHeight],h=x(s,y),c=h<t||h>a?t/h:1,u=s*c,p=y*c;i.width=u,i.height=p;let f=i.getContext("2d");return f.fillStyle="white",f.fillRect(0,0,u,p),r&&(f.filter=r),f.drawImage(o,0,0,u,p),URL.revokeObjectURL(l),i}async function S(e){const t=e.cloneNode(!0);if(document.body.append(t),!t.hasAttribute("width")&&!t.hasAttribute("height")){let a=t.hasAttribute("viewBox")?{x:0,y:0,width:300,height:150}:e.getBBox(),r=e.viewBox.baseVal.width?t.viewBox.baseVal.width:e.width.baseVal.value?e.width.baseVal.value:a.width,n=e.viewBox.baseVal.height?t.viewBox.baseVal.height:e.height.baseVal.value?e.height.baseVal.value:a.height;t.setAttribute("width",r),t.setAttribute("height",n)}let a=(new XMLSerializer).serializeToString(t),r=new Blob([a],{type:"image/svg+xml"}),n=URL.createObjectURL(r);return t.remove(),n}function z(e,t){this.w=e,this.h=t,this.size=e*t,this.arraybuffer=new ArrayBuffer(this.size),this.data=new Int8Array(this.arraybuffer)}function L(){this.area=0,this.len=0,this.curve={},this.pt=[],this.minX=1e5,this.minY=1e5,this.maxX=-1,this.maxY=-1}function D(e){this.n=e,this.tag=new Array(e),this.c=new Array(3*e),this.alphaCurve=0,this.vertex=new Array(e),this.alpha=new Array(e),this.alpha0=new Array(e),this.beta=new Array(e)}function R(e,t=1){let a=e.curve,r=a.n,n=[];n.push({x:a.c[3*(r-1)+2].x*t,y:a.c[3*(r-1)+2].y*t});for(let e=0;e<r;e++){let r=a.tag[e];"curve"===r?n.push({x:a.c[3*e+2].x*t,y:a.c[3*e+2].y*t}):"corner"===r&&n.push({x:a.c[3*e+1].x*t,y:a.c[3*e+1].y*t},{x:a.c[3*e+2].x*t,y:a.c[3*e+2].y*t})}return n}function j(e,{turnpolicy:a="majority",turdsize:r=1,optcurve:n=!0,alphamax:i=1,opttolerance:l=1,getPolygon:o=!0}={}){let s=[],h=[];return(()=>{let t,n=e.copy(),i={x:0,y:0};const l=e=>{let t=n.w*e.y+e.x;for(;t<n.size&&1!==n.data[t];)t++;return t<n.size&&n.index(t)},o=(e,t)=>{for(let a=2;a<5;a++){let r=0;for(let i=1-a;i<=a-1;i++)r+=n.at(e+i,t+a-1)?1:-1,r+=n.at(e+a-1,t+i-1)?1:-1,r+=n.at(e+i-1,t-a)?1:-1,r+=n.at(e-a,t+i)?1:-1;if(r>0)return 1;if(r<0)return 0}return 0},y=t=>{let r,i=new L,l=t.x,s=t.y,y=0,h=1;for(i.sign=e.at(t.x,t.y)?"+":"-";i.pt.push({x:l,y:s}),l>i.maxX&&(i.maxX=l),l<i.minX&&(i.minX=l),s>i.maxY&&(i.maxY=s),s<i.minY&&(i.minY=s),i.len++,l+=y,s+=h,i.area-=l*h,l!==t.x||s!==t.y;){let e=n.at(l+(y+h-1)/2,s+(h-y-1)/2),t=n.at(l+(y-h-1)/2,s+(h+y-1)/2);t&&!e?"right"===a||"black"===a&&"+"===i.sign||"white"===a&&"-"===i.sign||"majority"===a&&o(l,s)||"minority"===a&&!o(l,s)?(r=y,y=-h,h=r):(r=y,y=h,h=-r):t?(r=y,y=-h,h=r):e||(r=y,y=h,h=-r)}return i},h=e=>{let t,a,r=e.pt[0].y,i=e.len;for(let l=1;l<i;l++){let i=e.pt[l].x,o=e.pt[l].y;if(o!==r){a=r<o?r:o,t=e.maxX;for(let e=i;e<t;e++)n.flip(e,a);r=o}}};for(;i=l(i);)t=y(i),h(t),t.area>r&&s.push(t)})(),(()=>{function e(){this.data=[0,0,0,0,0,0,0,0,0]}function a(e,t,a,r,n){this.x=e,this.y=t,this.xy=a,this.x2=r,this.y2=n}e.prototype.at=function(e,t){return this.data[3*e+t]};const r=(e,t)=>e>=t?e%t:e>=0?e:t-1-(-1-e)%t,c=(e,t)=>e.x*t.y-e.y*t.x,u=(e,t,a)=>e<=a?e<=t&&t<a:e<=t||t<a,p=e=>e>0?1:e<0?-1:0,f=(e,t)=>{let a=new Array(3),r=0;a[0]=t.x,a[1]=t.y,a[2]=1;for(let t=0;t<3;t++)for(let n=0;n<3;n++)r+=a[t]*e.at(t,n)*a[n];return r},g=(e,t,a)=>({x:t.x+e*(a.x-t.x),y:t.y+e*(a.y-t.y)}),d=(e,t)=>{let a=((e,t)=>({x:-p(t.y-e.y),y:p(t.x-e.x)}))(e,t);return a.y*(t.x-e.x)-a.x*(t.y-e.y)},w=(e="",t={},a={},r={},n={})=>{let i,l,o,s;return"cprod"===e||"iprod1"===e?(i=a.x-t.x,o=a.y-t.y,l=n.x-r.x,s=n.y-r.y):(i=a.x-t.x,o=a.y-t.y,l=r.x-t.x,s=r.y-t.y),"cprod"===e||"dpara"===e?i*s-l*o:i*l+o*s},m=(e,t)=>v((e.x-t.x)**2+(e.y-t.y)**2),b=(e,t,a,r,n)=>{let i=1-e;return{x:i*i*i*t.x+i*i*e*3*a.x+e*e*i*3*r.x+e*e*e*n.x,y:i*i*i*t.y+i*i*e*3*a.y+e*e*i*3*r.y+e*e*e*n.y}},A=(e,t,a,r,n,i)=>{let l=w("cprod",e,t,n,i),o=w("cprod",t,a,n,i),s=l-2*o+w("cprod",a,r,n,i),y=-2*l+2*o,h=y*y-4*s*l;if(0===s||h<0)return-1;let c=v(h),u=(-y+c)/(2*s),x=(-y-c)/(2*s);return u>=0&&u<=1?u:x>=0&&x<=1?x:-1},$=e=>{e.x0=e.pt[0].x,e.y0=e.pt[0].y,e.sums=[];let t=e.sums;t.push(new a(0,0,0,0,0));for(let r=0;r<e.len;r++){let n=e.pt[r].x-e.x0,i=e.pt[r].y-e.y0;t.push(new a(t[r].x+n,t[r].y+i,t[r].xy+n*i,t[r].x2+n*n,t[r].y2+i*i))}},S=e=>{let a,n=e.len,i=e.pt,l=new Array(n),o=new Array(n),s=new Array(4);e.lon=new Array(n);let h,f,g,d,v,w,m,b,A=[{x:0,y:0},{x:0,y:0}],$={x:0,y:0},S={x:0,y:0},z={x:0,y:0},L=0;for(f=n-1;f>=0;f--)i[f].x!=i[L].x&&i[f].y!=i[L].y&&(L=f+1),o[f]=L;for(f=n-1;f>=0;f--){for(s[0]=s[1]=s[2]=s[3]=0,a=(3+3*(i[r(f+1,n)].x-i[f].x)+(i[r(f+1,n)].y-i[f].y))/2,s[a]++,A[0].x=0,A[0].y=0,A[1].x=0,A[1].y=0,L=o[f],d=f;;){if(h=0,a=(3+3*p(i[L].x-i[d].x)+p(i[L].y-i[d].y))/2,s[a]++,s[0]&&s[1]&&s[2]&&s[3]){l[f]=d,h=1;break}if($.x=i[L].x-i[f].x,$.y=i[L].y-i[f].y,c(A[0],$)<0||c(A[1],$)>0)break;if(t($.x)<=1&&t($.y)<=1||(S.x=$.x+($.y>=0&&($.y>0||$.x<0)?1:-1),S.y=$.y+($.x<=0&&($.x<0||$.y<0)?1:-1),c(A[0],S)>=0&&(A[0].x=S.x,A[0].y=S.y),S.x=$.x+($.y<=0&&($.y<0||$.x<0)?1:-1),S.y=$.y+($.x>=0&&($.x>0||$.y<0)?1:-1),c(A[1],S)<=0&&(A[1].x=S.x,A[1].y=S.y)),d=L,L=o[d],!u(L,f,d))break}0===h&&(z.x=p(i[L].x-i[d].x),z.y=p(i[L].y-i[d].y),$.x=i[d].x-i[f].x,$.y=i[d].y-i[f].y,v=c(A[0],$),w=c(A[0],z),m=c(A[1],$),b=c(A[1],z),g=1e7,w<0&&(g=y(v/-w)),b>0&&(g=x(g,y(-m/b))),l[f]=r(d+g,n))}for(g=l[n-1],e.lon[n-1]=g,f=n-2;f>=0;f--)u(f+1,l[f],g)&&(g=l[f]),e.lon[f]=g;for(f=n-1;u(r(f+1,n),g,e.lon[f]);f--)e.lon[f]=g},z=e=>{const t=(e,t,a)=>{let r,n,i,l,o,s,y,h,c,u,x,p,f,g,d=e.len,w=e.pt,m=e.sums,b=0;return a>=d&&(a-=d,b=1),0===b?(r=m[a+1].x-m[t].x,n=m[a+1].y-m[t].y,l=m[a+1].x2-m[t].x2,i=m[a+1].xy-m[t].xy,o=m[a+1].y2-m[t].y2,s=a+1-t):(r=m[a+1].x-m[t].x+m[d].x,n=m[a+1].y-m[t].y+m[d].y,l=m[a+1].x2-m[t].x2+m[d].x2,i=m[a+1].xy-m[t].xy+m[d].xy,o=m[a+1].y2-m[t].y2+m[d].y2,s=a+1-t+d),x=(w[t].x+w[a].x)/2-w[0].x,p=(w[t].y+w[a].y)/2-w[0].y,g=w[a].x-w[t].x,f=-(w[a].y-w[t].y),y=(l-2*r*x)/s+x*x,h=(i-r*p-n*x)/s+x*p,c=(o-2*n*p)/s+p*p,u=f*f*y+2*f*g*h+g*g*c,v(u)};let a,n,i,l,o,s,y,h=e.len,c=new Array(h+1),u=new Array(h+1),x=new Array(h),p=new Array(h+1),f=new Array(h+1),g=new Array(h+1);for(a=0;a<h;a++)y=r(e.lon[r(a-1,h)]-1,h),y==a&&(y=r(a+1,h)),x[a]=y<a?h:y;for(n=1,a=0;a<h;a++)for(;n<=x[a];)p[n]=a,n++;for(a=0,n=0;a<h;n++)f[n]=a,a=x[a];for(f[n]=h,i=n,a=h,n=i;n>0;n--)g[n]=a,a=p[a];for(g[0]=0,c[0]=0,n=1;n<=i;n++)for(a=g[n];a<=f[n];a++){for(s=-1,l=f[n-1];l>=p[a];l--)o=t(e,l,a)+c[l],(s<0||o<s)&&(u[a]=l,s=o);c[a]=s}for(e.m=i,e.po=new Array(i),a=h,n=i-1;a>0;n--)a=u[a],e.po[n]=a},L=a=>{const n=(e,a,r,n,i)=>{let l,o,s,y,h,c,u,x,p,f,g,d=e.len,w=e.sums,m=0;for(;r>=d;)r-=d,m+=1;for(;a>=d;)a-=d,m-=1;for(;r<0;)r+=d,m-=1;for(;a<0;)a+=d,m+=1;l=w[r+1].x-w[a].x+m*w[d].x,o=w[r+1].y-w[a].y+m*w[d].y,s=w[r+1].x2-w[a].x2+m*w[d].x2,y=w[r+1].xy-w[a].xy+m*w[d].xy,h=w[r+1].y2-w[a].y2+m*w[d].y2,c=r+1-a+m*d,n.x=l/c,n.y=o/c,u=(s-l*l/c)/c,x=(y-l*o/c)/c,p=(h-o*o/c)/c,f=(u+p+v((u-p)*(u-p)+4*x*x))/2,u-=f,p-=f,t(u)>=t(p)?(g=v(u*u+x*x),0!==g&&(i.x=-x/g,i.y=u/g)):(g=v(p*p+x*x),0!==g&&(i.x=-p/g,i.y=x/g)),0===g&&(i.x=i.y=0)};let i,l,o,s,y,h,c,u,x,p,g,d,w,m,b,A=a.m,$=a.po,S=a.len,z=a.pt,L=a.x0,R=a.y0,j=new Array(A),k=new Array(A),P=new Array(A),C=new Array(3),B={x:0,y:0};for(a.curve=new D(A),l=0;l<A;l++)o=$[r(l+1,A)],o=r(o-$[l],S)+$[l],j[l]={x:0,y:0},k[l]={x:0,y:0},n(a,$[l],o,j[l],k[l]);for(l=0;l<A;l++)if(P[l]=new e,i=k[l].x*k[l].x+k[l].y*k[l].y,0===i)for(o=0;o<3;o++)for(s=0;s<3;s++)P[l].data[3*o+s]=0;else for(C[0]=k[l].y,C[1]=-k[l].x,C[2]=-C[1]*j[l].y-C[0]*j[l].x,y=0;y<3;y++)for(s=0;s<3;s++)P[l].data[3*y+s]=C[y]*C[s]/i;for(l=0;l<A;l++){for(h=new e,c={x:0,y:0},B.x=z[$[l]].x-L,B.y=z[$[l]].y-R,o=r(l-1,A),y=0;y<3;y++)for(s=0;s<3;s++)h.data[3*y+s]=P[o].at(y,s)+P[l].at(y,s);for(;;){if(p=h.at(0,0)*h.at(1,1)-h.at(0,1)*h.at(1,0),0!==p){c.x=(-h.at(0,2)*h.at(1,1)+h.at(1,2)*h.at(0,1))/p,c.y=(h.at(0,2)*h.at(1,0)-h.at(1,2)*h.at(0,0))/p;break}for(h.at(0,0)>h.at(1,1)?(C[0]=-h.at(0,1),C[1]=h.at(0,0)):h.at(1,1)?(C[0]=-h.at(1,1),C[1]=h.at(1,0)):(C[0]=1,C[1]=0),i=C[0]*C[0]+C[1]*C[1],C[2]=-C[1]*B.y-C[0]*B.x,y=0;y<3;y++)for(s=0;s<3;s++)h.data[3*y+s]+=C[y]*C[s]/i}if(u=t(c.x-B.x),x=t(c.y-B.y),u<=.5&&x<=.5)a.curve.vertex[l]={x:c.x+L,y:c.y+R};else{if(g=f(h,B),w=B.x,m=B.y,0!==h.at(0,0))for(b=0;b<2;b++)c.y=B.y-.5+b,c.x=-(h.at(0,1)*c.y+h.at(0,2))/h.at(0,0),u=t(c.x-B.x),d=f(h,c),u<=.5&&d<g&&(g=d,w=c.x,m=c.y);if(0!==h.at(1,1))for(b=0;b<2;b++)c.x=B.x-.5+b,c.y=-(h.at(1,0)*c.x+h.at(1,2))/h.at(1,1),x=t(c.y-B.y),d=f(h,c),x<=.5&&d<g&&(g=d,w=c.x,m=c.y);for(y=0;y<2;y++)for(s=0;s<2;s++)c.x=B.x-.5+y,c.y=B.y-.5+s,d=f(h,c),d<g&&(g=d,w=c.x,m=c.y);a.curve.vertex[l]={x:w+L,y:m+R}}}},j=e=>{let t,a,r,n=e.curve,i=n.n,l=n.vertex;for(t=0,a=i-1;t<a;t++,a--)r=l[t],l[t]=l[a],l[a]=r},k=e=>{let a,n,l,o,s,y,h,c,u,x=e.curve.n,p=e.curve;for(a=0;a<x;a++)n=r(a+1,x),l=r(a+2,x),u=g(.5,p.vertex[l],p.vertex[n]),s=d(p.vertex[a],p.vertex[l]),0!==s?(o=w("dpara",p.vertex[a],p.vertex[n],p.vertex[l])/s,o=t(o),y=o>1?1-1/o:0,y/=.75):y=4/3,p.alpha0[n]=y,y>=i?(p.tag[n]="corner",p.c[3*n+1]=p.vertex[n],p.c[3*n+2]=u):(y<.55?y=.55:y>1&&(y=1),h=g(.5+.5*y,p.vertex[a],p.vertex[n]),c=g(.5+.5*y,p.vertex[l],p.vertex[n]),p.tag[n]="curve",p.c[3*n+0]=h,p.c[3*n+1]=c,p.c[3*n+2]=u),p.alpha[n]=y,p.beta[n]=.5;p.alphacurve=1},P=e=>{function a(){this.pen=0,this.c=[{x:0,y:0},{x:0,y:0}],this.t=0,this.s=0,this.alpha=0}const n=(e,a,n,i,l,o,s)=>{let y,h,c,u,x,f,d,$,S,z,L,D,R,j,k,P,C,B,E,F,M,O,T,V=e.curve.n,I=e.curve,X=I.vertex;if(a==n)return 1;if(y=a,x=r(a+1,V),h=r(y+1,V),u=o[h],0===u)return 1;for($=m(X[a],X[x]),y=h;y!=n;y=h){if(h=r(y+1,V),c=r(y+2,V),o[h]!=u)return 1;if(p(w("cprod",X[a],X[x],X[h],X[c]))!=u)return 1;if(w("iprod1",X[a],X[x],X[h],X[c])<$*m(X[h],X[c])*-.999847695156)return 1}if(L=I.c[3*r(a,V)+2],D=X[r(a+1,V)],R=X[r(n,V)],j=I.c[3*r(n,V)+2],f=s[n]-s[a],f-=w("dpara",X[0],I.c[3*a+2],I.c[3*n+2])/2,a>=n&&(f+=s[V]),B=w("dpara",L,D,R),E=w("dpara",L,D,j),F=w("dpara",L,R,j),M=B+F-E,E===B)return 1;if(T=F/(F-M),O=E/(E-B),P=E*T/2,0===P)return 1;for(C=f/P,d=2-v(4-C/.3),i.c[0]=g(T*d,L,D),i.c[1]=g(O*d,j,R),i.alpha=d,i.t=T,i.s=O,D={x:i.c[0].x,y:i.c[0].y},R={x:i.c[1].x,y:i.c[1].y},i.pen=0,y=r(a+1,V);y!=n;y=h){if(h=r(y+1,V),T=A(L,D,R,j,X[y],X[h]),T<-.5)return 1;if(k=b(T,L,D,R,j),$=m(X[y],X[h]),0===$)return 1;if(S=w("dpara",X[y],X[h],k)/$,t(S)>l)return 1;if(w("iprod",X[y],X[h],k)<0||w("iprod",X[h],X[y],k)<0)return 1;i.pen+=S*S}for(y=a;y!=n;y=h){if(h=r(y+1,V),T=A(L,D,R,j,I.c[3*y+2],I.c[3*h+2]),T<-.5)return 1;if(k=b(T,L,D,R,j),$=m(I.c[3*y+2],I.c[3*h+2]),0===$)return 1;if(S=w("dpara",I.c[3*y+2],I.c[3*h+2],k)/$,z=w("dpara",I.c[3*y+2],I.c[3*h+2],X[h])/$,z*=.75*I.alpha[h],z<0&&(S=-S,z=-z),S<z-l)return 1;S<z&&(i.pen+=(S-z)*(S-z))}return 0};let i,o,s,y,h,c,u,x,f,d,$,S=e.curve,z=S.n,L=S.vertex,R=new Array(z+1),j=new Array(z+1),k=new Array(z+1),P=new Array(z+1),C=new a,B=new Array(z),E=new Array(z+1);for(o=0;o<z;o++)"curve"==S.tag[o]?B[o]=p(w("dpara",L[r(o-1,z)],L[o],L[r(o+1,z)])):B[o]=0;for(u=0,E[0]=0,h=S.vertex[0],o=0;o<z;o++)c=r(o+1,z),"curve"==S.tag[c]&&(x=S.alpha[c],u+=.3*x*(4-x)*w("dpara",S.c[3*o+2],L[c],S.c[3*c+2])/2,u+=w("dpara",h,S.c[3*o+2],S.c[3*c+2])/2),E[o+1]=u;for(R[0]=-1,j[0]=0,k[0]=0,s=1;s<=z;s++)for(R[s]=s-1,j[s]=j[s-1],k[s]=k[s-1]+1,o=s-2;o>=0&&(y=n(e,o,r(s,z),C,l,B,E),!y);o--)(k[s]>k[o]+1||k[s]==k[o]+1&&j[s]>j[o]+C.pen)&&(R[s]=o,j[s]=j[o]+C.pen,k[s]=k[o]+1,P[s]=C,C=new a);for(i=k[z],f=new D(i),d=new Array(i),$=new Array(i),s=z,o=i-1;o>=0;o--)R[s]==s-1?(f.tag[o]=S.tag[r(s,z)],f.c[3*o+0]=S.c[3*r(s,z)+0],f.c[3*o+1]=S.c[3*r(s,z)+1],f.c[3*o+2]=S.c[3*r(s,z)+2],f.vertex[o]=S.vertex[r(s,z)],f.alpha[o]=S.alpha[r(s,z)],f.alpha0[o]=S.alpha0[r(s,z)],f.beta[o]=S.beta[r(s,z)],d[o]=$[o]=1):(f.tag[o]="curve",f.c[3*o+0]=P[s].c[0],f.c[3*o+1]=P[s].c[1],f.c[3*o+2]=S.c[3*r(s,z)+2],f.vertex[o]=g(P[s].s,S.c[3*r(s,z)+2],L[r(s,z)]),f.alpha[o]=P[s].alpha,f.alpha0[o]=P[s].alpha,d[o]=P[s].s,$[o]=P[s].t),s=R[s];for(o=0;o<i;o++)c=r(o+1,i),f.beta[o]=d[o]/(d[o]+$[c]);f.alphacurve=1,e.curve=f};for(let e=0;e<s.length;e++){let t=s[e];if($(t),S(t),z(t),L(t),"-"===t.sign&&j(t),k(t),o){let e=R(t);h.push(e)}n&&P(t)}})(),{pathList:s,polygons:h}}function k(e,t,a,r=!1){const n=(e,t,a)=>e>=t&&e<=a||e<=t&&e>=a;let i=!1;if((!r||!a.bottom)&&(a.left>e.x||a.top>e.y||a.bottom<e.y||a.right<e.x))return!1;for(let a=t.length-1,r=0;r<t.length;a=r,r++){const l=t[a],o=t[r];if(e.x==l.x&&e.y==l.y||e.x==o.x&&e.y==o.y)return!0;if(l.y==o.y&&e.y==l.y&&n(e.x,l.x,o.x))return!0;if(n(e.y,l.y,o.y)){if(e.y==l.y&&o.y>=l.y||e.y==o.y&&l.y>=o.y)continue;const t=(l.x-e.x)*(o.y-e.y)-(o.x-e.x)*(l.y-e.y);if(0==t)return!0;l.y<o.y==t>0&&(i=!i)}}return!!i}function P(e,t=!1){let a=[];return e[0].values[0],e[0].values[1],e.forEach(e=>{let{type:r,values:n}=e;if(n.length)if(t)for(let e=1;e<n.length;e+=2)a.push({x:n[e-1],y:n[e]});else a.push({x:n[n.length-2],y:n[n.length-1]})}),a}function C(e,t){let[a,r,n,i,l,o]=[e.x,e.y,e.width,e.height,e.x+e.width,e.y+e.height],[s,y,h,c,u,x]=[t.x,t.y,t.width,t.height,t.x+t.width,t.y+t.height],p=!1;return n*i!=h*c&&n*i>h*c&&a<s&&l>u&&r<y&&o>x&&(p=!0),p}function B(e,t=-1){let a=!("auto"!=t||!e[0].hasOwnProperty("decimals"));for(let r=0,n=e.length;r<n;r++){let n=e[r];(t>-1||a)&&(t=a?n.decimals:t,e[r].values=n.values.map(e=>e?+e.toFixed(t):e))}return e}function E(e,{toShorthands:a=!0,toRelative:r=!0,decimals:n=3}={}){return n>-1&&n<2&&(e=B(e,n)),a&&(e=function(e,a=-1,r=!0){let n;if(r){let t=e.map(e=>e.type).join("");n=/[astvqmhlc]/g.test(t)}e=r&&n?function(e,t=-1){return F(e,!1,t)}(e,a):e;let i={type:"M",values:e[0].values};e[0].decimals&&(i.decimals=e[0].decimals);let l,o=[i],s={x:e[0].values[0],y:e[0].values[1]},y=.01;for(let r=1,n=e.length;r<n;r++){let n=e[r],{type:h,values:c}=n,u=c.slice(-2),x=e[r-1],p=x.type;l={x:u[0],y:u[1]};let f,g,d,v,w={x:c[0],y:c[1]},m=t(l.x-s.x),b=t(l.y-s.y),A=(m+b)/2*y;switch(h){case"L":i=0===b||b<A&&m>A?{type:"H",values:[c[0]]}:0===m||b>A&&m<A?{type:"V",values:[c[1]]}:n;break;case"Q":if("Q"!==p){s={x:u[0],y:u[1]},o.push(n);continue}let e={x:x.values[0],y:x.values[1]};v={x:2*s.x-e.x,y:2*s.y-e.y},f=t(w.x-v.x),g=t(w.y-v.y),d=(f+g)/2,i=d<A?{type:"T",values:[l.x,l.y]}:n;break;case"C":let a={x:c[2],y:c[3]};if("C"!==p){o.push(n),s={x:u[0],y:u[1]};continue}let r={x:x.values[2],y:x.values[3]};v={x:2*s.x-r.x,y:2*s.y-r.y},f=t(w.x-v.x),g=t(w.y-v.y),d=(f+g)/2,i=d<A?{type:"S",values:[a.x,a.y,l.x,l.y]}:n;break;default:i={type:h,values:c}}(n.decimals||0===n.decimals)&&(i.decimals=n.decimals),a>-1&&(i.values=i.values.map(e=>+e.toFixed(a))),s={x:u[0],y:u[1]},o.push(i)}return o}(e)),r&&(e=function(e,t=-1){return F(e,!0,t)}(e)),n>-1&&(e=B(e,n)),e}function F(e,t=!1,a=-1){a>=0&&(e[0].values=e[0].values.map(e=>+e.toFixed(a)));let r=e[0].values,n=r[0],i=r[1],l=n,o=i;for(let r=1,s=e.length;r<s;r++){let s=e[r],{type:y,values:h}=s,c=t?y.toLowerCase():y.toUpperCase();if(y!==c)switch(y=c,s.type=y,y){case"a":case"A":h[5]=t?h[5]-n:h[5]+n,h[6]=t?h[6]-i:h[6]+i;break;case"v":case"V":h[0]=t?h[0]-i:h[0]+i;break;case"h":case"H":h[0]=t?h[0]-n:h[0]+n;break;case"m":case"M":t?(h[0]-=n,h[1]-=i):(h[0]+=n,h[1]+=i),l=t?h[0]+n:h[0],o=t?h[1]+i:h[1];break;default:if(h.length)for(let e=0;e<h.length;e++)h[e]=t?h[e]-(e%2?i:n):h[e]+(e%2?i:n)}let u=h.length;switch(y){case"z":case"Z":n=l,i=o;break;case"h":case"H":n=t?n+h[0]:h[0];break;case"v":case"V":i=t?i+h[0]:h[0];break;case"m":case"M":l=h[u-2]+(t?n:0),o=h[u-1]+(t?i:0);default:n=h[u-2]+(t?n:0),i=h[u-1]+(t?i:0)}a>=0&&(s.values=s.values.map(e=>+e.toFixed(a)))}return e}function M(e,t=!1,a=!0){let r=[],n=e.length,i=e[0].values[0],l=e[0].values[1];if(!("z"===e[n-1].type.toLowerCase()))return e;let o=0;if(a){let t=[];for(let a=0,r=e.length;a<r;a++){let r=e[a],{type:n,values:i}=r;if(i.length){let e=i.slice(-2),r={x:e[0],y:e[1],dist:0,index:0};r.index=a,t.push(r)}}t=t.sort((e,t)=>e.x-t.x||e.y-t.y),o=t[0].index}e=function(e,t){let a=e.length,r=0,n=e[a-1].type,i="z"===n.toLowerCase();if(!i||t<1||e.length<3)return e;let l=i?1:0;(function(e){let t=e.length,a="Z"==e[t-1].type,r=e[0],[n,i]=[r.values[0],r.values[1]].map(e=>+e.toFixed(8)),l=a?e[t-2]:e[t-1],o=l.values.length,[s,y]=[l.values[o-2],l.values[o-1]].map(e=>+e.toFixed(8));!a||n==s&&i==y||(e.pop(),e.push({type:"L",values:[n,i]},{type:"Z",values:[]}))})(e),r=t+1<e.length-1?t+1:e.length-1-l;let o=e.slice(r),s=e.slice(0,r);s.shift();let y,h,c=s.length;y=s[c-1].values||[],h=[y[y.length-2],y[y.length-1]],l&&(o.pop(),s.push({type:"Z",values:[]}));return e=[{type:"M",values:h},...o,...s],e}(e,o),n=e.length;let s=e[n-2],y=s.type,h=s.values.slice(-2),c="L"===y&&h[0]===i&&h[1]===l;return t&&c&&e.splice(n-2,1),r.push(...e),r}function O(e){let t={x:e[0].values[0],y:e[0].values[1]},a=t,r=[e[0]];for(let n=1,i=e.length;n<i;n++){let i=e[n],{type:l,values:o,t:s=0}=i,y=o.slice(-2);a={x:y[0],y:y[1]},"L"===l&&a.x===t.x&&a.y===t.y||(r.push(i),t=a)}return r}function T(e,t=.001){let a=0;for(let t=0,r=e.length;r&&t<r;t++){a+=e[t].x*e[t===e.length-1?0:t+1].y*.5-e[t===e.length-1?0:t+1].x*e[t].y*.5}return a}function V(e,a=1e-5){let r=[e[0]],n={x:e[0].values[0],y:e[0].values[1]},i=n,l=n;for(let o=1,s=e.length;o<s;o++){let y=e[o],h=e[o+1]||e[s-1],c="Z"===h.type?n:{x:h.values[h.values.length-2],y:h.values[h.values.length-1]},{type:u,values:x}=y,p=x.slice(-2);l="Z"!==u?{x:p[0],y:p[1]}:n;let f="C"===u?[{x:x[0],y:x[1]},{x:x[2],y:x[3]}]:"Q"===u?[{x:x[0],y:x[1]}]:[],g=t(T([i,...f,l,c]));i=l,g<a||("M"===u?(n=l,i=n):"Z"===u&&(i=n),r.push(y))}return r.push({type:"Z",values:[]}),r}function I(e,t=-1,a=!1){"l"===e[1].type&&a&&(e[0].type="m");let r=`${e[0].type}${e[0].values.join(" ")}`;for(let n=1;n<e.length;n++){let i=e[n-1],l=e[n],o=i.type===l.type&&a||("m"===i.type&&"l"===l.type||"M"===i.type&&"l"===l.type||"M"===i.type&&"L"===l.type)&&a?" ":l.type;l.values.length&&t>-1&&(l.values=l.values.map(e=>+e.toFixed(t))),r+=`${o}${l.values.join(" ")}`}return a&&(r=r.replaceAll(" 0."," .").replaceAll(" -","-").replaceAll("-0.","-.").replace(/\s+([mlcsqtahvz])/gi,"$1").replaceAll("Z","z")),r}function X(e,t,a,{toRelative:r=!0,toShorthands:n=!0,decimals:i=3,addDimensions:o=!1,optimize:s=!0,getPDF:h=!0}={}){t=l(t),a=l(a);let c=[],u=e.length;for(let t=0;t<u;t++){let a=e[t],r=a[0].bb,n=P(a,true);c.push({pathData:a,bb:r,poly:n,includes:[]})}if(s)for(let e=0,t=c.length;e<t;e++){let{pathData:t,bb:a}=c[e];t=O(t),t=M(t),t=V(t),c[e].pathData=t}for(let e=0,t=c.length;e<t;e++){let a=c[e],{bb:r,poly:n}=a;for(let a=0;a<t;a++){let t=c[a];if(e===a)continue;let[i,l]=[t.bb,t.poly];if(!C(r,i))continue;let o=[{x:i.x+.5*i.width,y:i.y+.5*i.height},l[0],l[y(l.length/2)],l[l.length-1]],s=!1;for(let e=0;e<o.length;e++){if(k(o[e],n,r,!0)){s=!0;break}}s&&c[e].includes.push(a)}}for(let e=0,t=c.length;e<t;e++){let t=c[e],{includes:a}=t;a.forEach(t=>{let a=c[t].pathData;a.length&&(c[e].pathData.push(...a),c[t].pathData=[])})}c=c.filter(e=>e.pathData.length);let x=JSON.parse(JSON.stringify(c)).map(e=>e.pathData),p=JSON.parse(JSON.stringify(x)).flat(),f=o?`width="${t}" height="${a}" `:"",g=`<svg viewBox="0 0 ${t} ${a}" ${f}xmlns="http://www.w3.org/2000/svg">`,d=[];c.forEach(e=>{let{pathData:t}=e;try{(r||n||-1!=i)&&(t=E(t,{toRelative:r,toShorthands:n,decimals:i}));let e=I(t,i);d.push(e),g+=`<path d="${e}"/>`}catch{console.warn("catch pathdata could not be parsed",t)}}),g+="</svg>",(r||n||-1!=i)&&(p=E(p,{toRelative:r,toShorthands:n,decimals:i}));let v=I(p,i),w=`<svg viewBox="0 0 ${t} ${a}" ${f}xmlns="http://www.w3.org/2000/svg"><path d="${v}"/></svg>`,m="";if(h)try{m=function(e=[],{width:t=0,height:a=0}={}){let r="";e.forEach(e=>{r+=function(e,{height:t=0,decimals:a=3}={}){let r=["q","0 0 0 1 k"];return e.forEach(e=>{let{type:n,values:i}=e;if(i.length){let e=t;for(let t=1,r=i.length;t<r;t+=2)i[t-1]=i[t-1].toFixed(a),i[t]=+(e-i[t]).toFixed(a)}let l=i.length?`${i.join(" ")} ${n.toLowerCase()}`:"h";r.push(l)}),r.push("f","Q"),r.join("\n")}(e,{height:a})+"\n"});let n=(new TextEncoder).encode(r).length,i="%PDF-1.4\n",l=["<<\n/Type /Catalog\n/Pages 2 0 R\n>>","<<\n/Type /Pages\n/Kids [3 0 R]\n/Count 1\n>>",`<<\n/Type /Page\n/Parent 2 0 R\n/MediaBox [0 0 ${t} ${a}]\n/Contents 4 0 R\n>>`,`<<\n/Length ${n}\n>>\nstream\n${r}endstream`],o=[];for(let e=0;e<l.length;e++)o.push(i.length),i+=`${e+1} 0 obj\n${l[e]}\nendobj\n`;let s=(new TextEncoder).encode(i).length;i+=`xref\n0 ${l.length+1}\n`,i+="0000000000 65535 f \n";for(let e of o)i+=`${String(e).padStart(10,"0")} 00000 n \n`;return i+=`trailer\n<<\n/Size ${l.length+1}\n/Root 1 0 R\n>>\n`,i+=`startxref\n${s}\n%%EOF`,i}(x,{width:t,height:a})}catch{console.warn("pdf generation failed")}return{width:t,height:a,commands:p.length,svg:w,d:v,svgSplit:g,dArr:d,pathData:p,pathDataArr:x,pdf:m}}function U(e={}){Object.assign(this,e)}async function Y(e,{turnpolicy:t="majority",turdsize:a=1,optcurve:r=!0,alphamax:n=1,opttolerance:i=1,minSize:l=1e3,maxSize:o=5e3,scale:s=1,brightness:y=1,contrast:h=1,invert:c=0,blur:u=0,crop:x=!0,optimize:p=!0,addDimensions:f=!0,toRelative:g=!0,toShorthands:d=!0,decimals:v=3,getPolygon:w=!0,getPDF:m=!0}={}){let A=await b(e,{minSize:l,maxSize:o,crop:x,scale:s,brightness:y,contrast:h,invert:c,blur:u}),{bmp:$,scaleAdjust:S,width:z,height:L}=A,{pathList:D,polygons:R}=j($,{turnpolicy:t,turdsize:a,optcurve:r,alphamax:n,opttolerance:i,scaleAdjust:S,minSize:l,maxSize:o,getPolygon:w}),k=function(e=[],t=1){e.sort((e,t)=>e.minX-t.minX||e.minY-t.minY);let a=e.length,r=[];for(let n=0;n<a;n++){let a,i=[],l=e[n],{curve:o,minX:s,maxX:y,minY:h,maxY:c,sign:u}=l,x={x:s,y:h,width:y-s,height:c-h},p=o.n;i.push({type:"M",values:[o.c[3*(p-1)+2].x*t,o.c[3*(p-1)+2].y*t],bb:x,cw:"+"===u});for(let e=0;e<p;e++){let r=o.tag[e];"curve"===r?a=[{type:"C",values:[o.c[3*e].x*t,o.c[3*e].y*t,o.c[3*e+1].x*t,o.c[3*e+1].y*t,o.c[3*e+2].x*t,o.c[3*e+2].y*t]}]:"corner"===r&&(a=[{type:"L",values:[o.c[3*e+1].x*t,o.c[3*e+1].y*t]},{type:"L",values:[o.c[3*e+2].x*t,o.c[3*e+2].y*t]}]),i.push(...a)}i.push({type:"Z",values:[]}),r.push(i)}return r}(D,s=1/S);if(!k.flat().length)throw new Error("Couldn't trace image");let P=X(k,z,L,{addDimensions:f,toRelative:g,toShorthands:d,optimize:p,decimals:v,getPDF:m});return P.scaleAdjust=S,P.polygons=w?R:[],new U(P)}z.prototype.at=function(e,t){return e>=0&&e<this.w&&t>=0&&t<this.h&&1===this.data[this.w*t+e]},z.prototype.index=function(e){let t={x:0,y:y(e/this.w)};return t.x=e-t.y*this.w,t},z.prototype.flip=function(e,t){this.at(e,t)?this.data[this.w*t+e]=0:this.data[this.w*t+e]=1},z.prototype.copy=function(){let e,t=new z(this.w,this.h);for(e=0;e<this.size;e++)t.data[e]=this.data[e];return t},U.prototype.getPdf=function(){return URL.createObjectURL(new Blob([this.pdf],{type:"application/pdf"}))},U.prototype.getSVG=function(e=!1){return e?this.svgSplit:this.svg},U.prototype.getPathData=function(){return this.pathDataNorm},U.prototype.getPathDataNorm=function(){return this.pathDataNorm},U.prototype.getD=function(){return this.d},"undefined"!=typeof window&&(window.pathDataToD=I,window.PotracePlus=Y,window.svg2Canvas=$),e.PI=m,e.PotraceObj=U,e.PotracePlus=Y,e.abs=t,e.acos=a,e.asin=r,e.atan=n,e.atan2=i,e.ceil=l,e.cos=o,e.exp=s,e.floor=y,e.hypot=c,e.log=h,e.max=u,e.min=x,e.pow=p,e.random=f,e.round=g,e.sin=d,e.sqrt=v,e.svg2Canvas=$,e.tan=w}(this["potrace-plus"]=this["potrace-plus"]||{});
