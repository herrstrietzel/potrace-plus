const{abs:t,acos:e,asin:a,atan:r,atan2:n,ceil:i,cos:y,exp:s,floor:l,log:o,hypot:c,max:x,min:u,pow:h,random:f,round:p,sin:d,sqrt:v,tan:m,PI:w}=Math;function g(t,e){this.w=t,this.h=e,this.size=t*e,this.arraybuffer=new ArrayBuffer(this.size),this.data=new Int8Array(this.arraybuffer)}async function b(t,{minSize:e=1e3,maxSize:a=5e3,filter:r="",scale:n=1,canvas:i=null}={}){let y,s=function(t){return t instanceof HTMLImageElement?"img":t instanceof SVGElement?"svg":t instanceof HTMLCanvasElement?"canvas":t instanceof File?"file":t instanceof ArrayBuffer?"buffer":"string"==typeof t?/^(file:|https?:\/\/|\/|\.\/|\.\.\/)/.test(t)?"url":"string":"unknown"}(t),l={minSize:e,maxSize:a,filter:r,scale:n,canvas:i};if("img"===s){let e=t.src;y=await async function(t="",{minSize:e=1e3,maxSize:a=5e3,filter:r="",scale:n=1,canvas:i=null}={}){let y,s,l,o,c,x,u=1,h=0;e*=n,a*=n,i||(i=new OffscreenCanvas(300,150));let f=i.getContext("2d"),p=await fetch(t);if(p.ok){let r=await p.blob(),{type:n}=r;"image/svg+xml"!==n?(y=await createImageBitmap(r),[s,l]=[y.width,y.height],i.width=s,i.height=l,f.drawImage(y,0,0),o=f.getImageData(0,0,s,l)):(y=new Image,y.src=t,y.crossOrigin="anonymous",await y.decode(),s=y.naturalWidth,l=y.naturalHeight,h=Math.min(s,l),u=h<e||h>a?e/h:1,c=s*u,x=l*u,i.width=c,i.height=x,f=i.getContext("2d"),f.fillStyle="white",f.fillRect(0,0,c,x),f.drawImage(y,0,0,c,x),o=f.getImageData(0,0,c,x))}let{width:d,height:v}=o;return d=Math.ceil(d/u),v=Math.ceil(v/u),{imgData:o,scaleAdjust:u,width:d,height:v}}(e,l)}let{imgData:o,scaleAdjust:c,width:x,height:u}=y,h=function(t){let e,{data:a,width:r,height:n}=t,i=new g(r,n),y=a.length;for(let t=0,r=0;t<y;t+=4,r++)e=a[t],i.data[r]=e<128?1:0;return i}(o);return{bmp:h,scaleAdjust:c,width:x,height:u}}function A(){this.area=0,this.len=0,this.curve={},this.pt=[],this.minX=1e5,this.minY=1e5,this.maxX=-1,this.maxY=-1}function M(t){this.n=t,this.tag=new Array(t),this.c=new Array(3*t),this.alphaCurve=0,this.vertex=new Array(t),this.alpha=new Array(t),this.alpha0=new Array(t),this.beta=new Array(t)}function z(t,e=-1){let a=!("auto"!=e||!t[0].hasOwnProperty("decimals"));for(let r=0,n=t.length;r<n;r++){let n=t[r];(e>-1||a)&&(e=a?n.decimals:e,t[r].values=n.values.map(t=>t?+t.toFixed(e):t))}return t}function S(t,{toShorthands:e=!0,toRelative:a=!0,decimals:r=3}={}){return r>-1&&r<2&&(t=z(t,r)),e&&(t=function(t,e=-1,a=!0){let r;if(a){let e=t.map(t=>t.type).join("");r=/[astvqmhlc]/g.test(e)}t=a&&r?function(t,e=-1){return k(t,!1,e)}(t,e):t;let n={type:"M",values:t[0].values};t[0].decimals&&(n.decimals=t[0].decimals);let i,y=[n],s={x:t[0].values[0],y:t[0].values[1]},l=.01;for(let a=1,r=t.length;a<r;a++){let r=t[a],{type:o,values:c}=r,x=c.slice(-2),u=t[a-1],h=u.type;i={x:x[0],y:x[1]};let f,p,d,v,m={x:c[0],y:c[1]},w=Math.abs(i.x-s.x),g=Math.abs(i.y-s.y),b=(w+g)/2*l;switch(o){case"L":n=0===g||g<b&&w>b?{type:"H",values:[c[0]]}:0===w||g>b&&w<b?{type:"V",values:[c[1]]}:r;break;case"Q":if("Q"!==h){s={x:x[0],y:x[1]},y.push(r);continue}let t={x:u.values[0],y:u.values[1]};v={x:2*s.x-t.x,y:2*s.y-t.y},f=Math.abs(m.x-v.x),p=Math.abs(m.y-v.y),d=(f+p)/2,n=d<b?{type:"T",values:[i.x,i.y]}:r;break;case"C":let e={x:c[2],y:c[3]};if("C"!==h){y.push(r),s={x:x[0],y:x[1]};continue}let a={x:u.values[2],y:u.values[3]};v={x:2*s.x-a.x,y:2*s.y-a.y},f=Math.abs(m.x-v.x),p=Math.abs(m.y-v.y),d=(f+p)/2,n=d<b?{type:"S",values:[e.x,e.y,i.x,i.y]}:r;break;default:n={type:o,values:c}}(r.decimals||0===r.decimals)&&(n.decimals=r.decimals),e>-1&&(n.values=n.values.map(t=>+t.toFixed(e))),s={x:x[0],y:x[1]},y.push(n)}return y}(t)),a&&(t=function(t,e=-1){return k(t,!0,e)}(t)),r>-1&&(t=z(t,r)),t}function k(t,e=!1,a=-1){a>=0&&(t[0].values=t[0].values.map(t=>+t.toFixed(a)));let r=t[0].values,n=r[0],i=r[1],y=n,s=i;for(let r=1,l=t.length;r<l;r++){let l=t[r],{type:o,values:c}=l,x=e?o.toLowerCase():o.toUpperCase();if(o!==x)switch(o=x,l.type=o,o){case"a":case"A":c[5]=e?c[5]-n:c[5]+n,c[6]=e?c[6]-i:c[6]+i;break;case"v":case"V":c[0]=e?c[0]-i:c[0]+i;break;case"h":case"H":c[0]=e?c[0]-n:c[0]+n;break;case"m":case"M":e?(c[0]-=n,c[1]-=i):(c[0]+=n,c[1]+=i),y=e?c[0]+n:c[0],s=e?c[1]+i:c[1];break;default:if(c.length)for(let t=0;t<c.length;t++)c[t]=e?c[t]-(t%2?i:n):c[t]+(t%2?i:n)}let u=c.length;switch(o){case"z":case"Z":n=y,i=s;break;case"h":case"H":n=e?n+c[0]:c[0];break;case"v":case"V":i=e?i+c[0]:c[0];break;case"m":case"M":y=c[u-2]+(e?n:0),s=c[u-1]+(e?i:0);default:n=c[u-2]+(e?n:0),i=c[u-1]+(e?i:0)}a>=0&&(l.values=l.values.map(t=>+t.toFixed(a)))}return t}function j(t,{turnpolicy:e="majority",turdsize:a=1,optcurve:r=!0,alphamax:n=1,opttolerance:i=1}={}){let y=[];return function(){let r,n=t.copy(),i={x:0,y:0};function s(t){let e=n.w*t.y+t.x;for(;e<n.size&&1!==n.data[e];)e++;return e<n.size&&n.index(e)}function l(t,e){for(let a=2;a<5;a++){let r=0;for(let i=1-a;i<=a-1;i++)r+=n.at(t+i,e+a-1)?1:-1,r+=n.at(t+a-1,e+i-1)?1:-1,r+=n.at(t+i-1,e-a)?1:-1,r+=n.at(t-a,e+i)?1:-1;if(r>0)return 1;if(r<0)return 0}return 0}function o(a){let r,i=new A,y=a.x,s=a.y,o=0,c=1;for(i.sign=t.at(a.x,a.y)?"+":"-";i.pt.push({x:y,y:s}),y>i.maxX&&(i.maxX=y),y<i.minX&&(i.minX=y),s>i.maxY&&(i.maxY=s),s<i.minY&&(i.minY=s),i.len++,y+=o,s+=c,i.area-=y*c,y!==a.x||s!==a.y;){let t=n.at(y+(o+c-1)/2,s+(c-o-1)/2),a=n.at(y+(o-c-1)/2,s+(c+o-1)/2);a&&!t?"right"===e||"black"===e&&"+"===i.sign||"white"===e&&"-"===i.sign||"majority"===e&&l(y,s)||"minority"===e&&!l(y,s)?(r=o,o=-c,c=r):(r=o,o=c,c=-r):a?(r=o,o=-c,c=r):t||(r=o,o=c,c=-r)}return i}function c(t){let e,a,r=t.pt[0].y,i=t.len;for(let y=1;y<i;y++){let i=t.pt[y].x,s=t.pt[y].y;if(s!==r){a=r<s?r:s,e=t.maxX;for(let t=i;t<e;t++)n.flip(t,a);r=s}}}for(;i=s(i);)r=o(i),c(r),r.area>a&&y.push(r)}(),function(){function t(){this.data=[0,0,0,0,0,0,0,0,0]}function e(t,e,a,r,n){this.x=t,this.y=e,this.xy=a,this.x2=r,this.y2=n}function a(t,e){return t>=e?t%e:t>=0?t:e-1-(-1-t)%e}function s(t,e){return t.x*e.y-t.y*e.x}function l(t,e,a){return t<=a?t<=e&&e<a:t<=e||e<a}function o(t){return t>0?1:t<0?-1:0}function c(t,e){let a=new Array(3),r=0;a[0]=e.x,a[1]=e.y,a[2]=1;for(let e=0;e<3;e++)for(let n=0;n<3;n++)r+=a[e]*t.at(e,n)*a[n];return r}function x(t,e,a){return{x:e.x+t*(a.x-e.x),y:e.y+t*(a.y-e.y)}}function u(t,e){let a=function(t,e){return{x:-o(e.y-t.y),y:o(e.x-t.x)}}(t,e);return a.y*(e.x-t.x)-a.x*(e.y-t.y)}function h(t="",e={},a={},r={},n={}){let i,y,s,l;return"cprod"===t||"iprod1"===t?(i=a.x-e.x,s=a.y-e.y,y=n.x-r.x,l=n.y-r.y):(i=a.x-e.x,s=a.y-e.y,y=r.x-e.x,l=r.y-e.y),"cprod"===t||"dpara"===t?i*l-y*s:i*y+s*l}function f(t,e){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}function p(t,e,a,r,n){let i=1-t;return{x:i*i*i*e.x+i*i*t*3*a.x+t*t*i*3*r.x+t*t*t*n.x,y:i*i*i*e.y+i*i*t*3*a.y+t*t*i*3*r.y+t*t*t*n.y}}function d(t,e,a,r,n,i){let y=h("cprod",t,e,n,i),s=h("cprod",e,a,n,i),l=y-2*s+h("cprod",a,r,n,i),o=-2*y+2*s,c=o*o-4*l*y;if(0===l||c<0)return-1;let x=Math.sqrt(c),u=(-o+x)/(2*l),f=(-o-x)/(2*l);return u>=0&&u<=1?u:f>=0&&f<=1?f:-1}function v(t){t.x0=t.pt[0].x,t.y0=t.pt[0].y,t.sums=[];let a=t.sums;a.push(new e(0,0,0,0,0));for(let r=0;r<t.len;r++){let n=t.pt[r].x-t.x0,i=t.pt[r].y-t.y0;a.push(new e(a[r].x+n,a[r].y+i,a[r].xy+n*i,a[r].x2+n*n,a[r].y2+i*i))}}function m(t){let e,r=t.len,n=t.pt,i=new Array(r),y=new Array(r),c=new Array(4);t.lon=new Array(r);let x,u,h,f,p,d,v,m,w=[{x:0,y:0},{x:0,y:0}],g={x:0,y:0},b={x:0,y:0},A={x:0,y:0},M=0;for(u=r-1;u>=0;u--)n[u].x!=n[M].x&&n[u].y!=n[M].y&&(M=u+1),y[u]=M;for(u=r-1;u>=0;u--){for(c[0]=c[1]=c[2]=c[3]=0,e=(3+3*(n[a(u+1,r)].x-n[u].x)+(n[a(u+1,r)].y-n[u].y))/2,c[e]++,w[0].x=0,w[0].y=0,w[1].x=0,w[1].y=0,M=y[u],f=u;;){if(x=0,e=(3+3*o(n[M].x-n[f].x)+o(n[M].y-n[f].y))/2,c[e]++,c[0]&&c[1]&&c[2]&&c[3]){i[u]=f,x=1;break}if(g.x=n[M].x-n[u].x,g.y=n[M].y-n[u].y,s(w[0],g)<0||s(w[1],g)>0)break;if(Math.abs(g.x)<=1&&Math.abs(g.y)<=1||(b.x=g.x+(g.y>=0&&(g.y>0||g.x<0)?1:-1),b.y=g.y+(g.x<=0&&(g.x<0||g.y<0)?1:-1),s(w[0],b)>=0&&(w[0].x=b.x,w[0].y=b.y),b.x=g.x+(g.y<=0&&(g.y<0||g.x<0)?1:-1),b.y=g.y+(g.x>=0&&(g.x>0||g.y<0)?1:-1),s(w[1],b)<=0&&(w[1].x=b.x,w[1].y=b.y)),f=M,M=y[f],!l(M,u,f))break}0===x&&(A.x=o(n[M].x-n[f].x),A.y=o(n[M].y-n[f].y),g.x=n[f].x-n[u].x,g.y=n[f].y-n[u].y,p=s(w[0],g),d=s(w[0],A),v=s(w[1],g),m=s(w[1],A),h=1e7,d<0&&(h=Math.floor(p/-d)),m>0&&(h=Math.min(h,Math.floor(-v/m))),i[u]=a(f+h,r))}for(h=i[r-1],t.lon[r-1]=h,u=r-2;u>=0;u--)l(u+1,i[u],h)&&(h=i[u]),t.lon[u]=h;for(u=r-1;l(a(u+1,r),h,t.lon[u]);u--)t.lon[u]=h}function w(t){function e(t,e,a){let r,n,i,y,s,l,o,c,x,u,h,f,p,d,v=t.len,m=t.pt,w=t.sums,g=0;return a>=v&&(a-=v,g=1),0===g?(r=w[a+1].x-w[e].x,n=w[a+1].y-w[e].y,y=w[a+1].x2-w[e].x2,i=w[a+1].xy-w[e].xy,s=w[a+1].y2-w[e].y2,l=a+1-e):(r=w[a+1].x-w[e].x+w[v].x,n=w[a+1].y-w[e].y+w[v].y,y=w[a+1].x2-w[e].x2+w[v].x2,i=w[a+1].xy-w[e].xy+w[v].xy,s=w[a+1].y2-w[e].y2+w[v].y2,l=a+1-e+v),h=(m[e].x+m[a].x)/2-m[0].x,f=(m[e].y+m[a].y)/2-m[0].y,d=m[a].x-m[e].x,p=-(m[a].y-m[e].y),o=(y-2*r*h)/l+h*h,c=(i-r*f-n*h)/l+h*f,x=(s-2*n*f)/l+f*f,u=p*p*o+2*p*d*c+d*d*x,Math.sqrt(u)}let r,n,i,y,s,l,o,c=t.len,x=new Array(c+1),u=new Array(c+1),h=new Array(c),f=new Array(c+1),p=new Array(c+1),d=new Array(c+1);for(r=0;r<c;r++)o=a(t.lon[a(r-1,c)]-1,c),o==r&&(o=a(r+1,c)),h[r]=o<r?c:o;for(n=1,r=0;r<c;r++)for(;n<=h[r];)f[n]=r,n++;for(r=0,n=0;r<c;n++)p[n]=r,r=h[r];for(p[n]=c,i=n,r=c,n=i;n>0;n--)d[n]=r,r=f[r];for(d[0]=0,x[0]=0,n=1;n<=i;n++)for(r=d[n];r<=p[n];r++){for(l=-1,y=p[n-1];y>=f[r];y--)s=e(t,y,r)+x[y],(l<0||s<l)&&(u[r]=y,l=s);x[r]=l}for(t.m=i,t.po=new Array(i),r=c,n=i-1;r>0;n--)r=u[r],t.po[n]=r}function g(e){function r(t,e,a,r,n){let i,y,s,l,o,c,x,u,h,f,p,d=t.len,v=t.sums,m=0;for(;a>=d;)a-=d,m+=1;for(;e>=d;)e-=d,m-=1;for(;a<0;)a+=d,m-=1;for(;e<0;)e+=d,m+=1;i=v[a+1].x-v[e].x+m*v[d].x,y=v[a+1].y-v[e].y+m*v[d].y,s=v[a+1].x2-v[e].x2+m*v[d].x2,l=v[a+1].xy-v[e].xy+m*v[d].xy,o=v[a+1].y2-v[e].y2+m*v[d].y2,c=a+1-e+m*d,r.x=i/c,r.y=y/c,x=(s-i*i/c)/c,u=(l-i*y/c)/c,h=(o-y*y/c)/c,f=(x+h+Math.sqrt((x-h)*(x-h)+4*u*u))/2,x-=f,h-=f,Math.abs(x)>=Math.abs(h)?(p=Math.sqrt(x*x+u*u),0!==p&&(n.x=-u/p,n.y=x/p)):(p=Math.sqrt(h*h+u*u),0!==p&&(n.x=-h/p,n.y=u/p)),0===p&&(n.x=n.y=0)}let n,i,y,s,l,o,x,u,h,f,p,d,v,m,w,g=e.m,b=e.po,A=e.len,z=e.pt,S=e.x0,k=e.y0,j=new Array(g),D=new Array(g),$=new Array(g),q=new Array(3),C={x:0,y:0};for(e.curve=new M(g),i=0;i<g;i++)y=b[a(i+1,g)],y=a(y-b[i],A)+b[i],j[i]={x:0,y:0},D[i]={x:0,y:0},r(e,b[i],y,j[i],D[i]);for(i=0;i<g;i++)if($[i]=new t,n=D[i].x*D[i].x+D[i].y*D[i].y,0===n)for(y=0;y<3;y++)for(s=0;s<3;s++)$[i].data[3*y+s]=0;else for(q[0]=D[i].y,q[1]=-D[i].x,q[2]=-q[1]*j[i].y-q[0]*j[i].x,l=0;l<3;l++)for(s=0;s<3;s++)$[i].data[3*l+s]=q[l]*q[s]/n;for(i=0;i<g;i++){for(o=new t,x={x:0,y:0},C.x=z[b[i]].x-S,C.y=z[b[i]].y-k,y=a(i-1,g),l=0;l<3;l++)for(s=0;s<3;s++)o.data[3*l+s]=$[y].at(l,s)+$[i].at(l,s);for(;;){if(f=o.at(0,0)*o.at(1,1)-o.at(0,1)*o.at(1,0),0!==f){x.x=(-o.at(0,2)*o.at(1,1)+o.at(1,2)*o.at(0,1))/f,x.y=(o.at(0,2)*o.at(1,0)-o.at(1,2)*o.at(0,0))/f;break}for(o.at(0,0)>o.at(1,1)?(q[0]=-o.at(0,1),q[1]=o.at(0,0)):o.at(1,1)?(q[0]=-o.at(1,1),q[1]=o.at(1,0)):(q[0]=1,q[1]=0),n=q[0]*q[0]+q[1]*q[1],q[2]=-q[1]*C.y-q[0]*C.x,l=0;l<3;l++)for(s=0;s<3;s++)o.data[3*l+s]+=q[l]*q[s]/n}if(u=Math.abs(x.x-C.x),h=Math.abs(x.y-C.y),u<=.5&&h<=.5)e.curve.vertex[i]={x:x.x+S,y:x.y+k};else{if(p=c(o,C),v=C.x,m=C.y,0!==o.at(0,0))for(w=0;w<2;w++)x.y=C.y-.5+w,x.x=-(o.at(0,1)*x.y+o.at(0,2))/o.at(0,0),u=Math.abs(x.x-C.x),d=c(o,x),u<=.5&&d<p&&(p=d,v=x.x,m=x.y);if(0!==o.at(1,1))for(w=0;w<2;w++)x.x=C.x-.5+w,x.y=-(o.at(1,0)*x.x+o.at(1,2))/o.at(1,1),h=Math.abs(x.y-C.y),d=c(o,x),h<=.5&&d<p&&(p=d,v=x.x,m=x.y);for(l=0;l<2;l++)for(s=0;s<2;s++)x.x=C.x-.5+l,x.y=C.y-.5+s,d=c(o,x),d<p&&(p=d,v=x.x,m=x.y);e.curve.vertex[i]={x:v+S,y:m+k}}}}function b(t){let e,a,r,n=t.curve,i=n.n,y=n.vertex;for(e=0,a=i-1;e<a;e++,a--)r=y[e],y[e]=y[a],y[a]=r}function A(t){let e,r,i,y,s,l,o,c,f,p=t.curve.n,d=t.curve;for(e=0;e<p;e++)r=a(e+1,p),i=a(e+2,p),f=x(.5,d.vertex[i],d.vertex[r]),s=u(d.vertex[e],d.vertex[i]),0!==s?(y=h("dpara",d.vertex[e],d.vertex[r],d.vertex[i])/s,y=Math.abs(y),l=y>1?1-1/y:0,l/=.75):l=4/3,d.alpha0[r]=l,l>=n?(d.tag[r]="corner",d.c[3*r+1]=d.vertex[r],d.c[3*r+2]=f):(l<.55?l=.55:l>1&&(l=1),o=x(.5+.5*l,d.vertex[e],d.vertex[r]),c=x(.5+.5*l,d.vertex[i],d.vertex[r]),d.tag[r]="curve",d.c[3*r+0]=o,d.c[3*r+1]=c,d.c[3*r+2]=f),d.alpha[r]=l,d.beta[r]=.5;d.alphacurve=1}function z(t){function e(){this.pen=0,this.c=[{x:0,y:0},{x:0,y:0}],this.t=0,this.s=0,this.alpha=0}function r(t,e,r,n,i,y,s){let l,c,u,v,m,w,g,b,A,M,z,S,k,j,D,$,q,C,I,L,X,F,H,O=t.curve.n,R=t.curve,Y=R.vertex;if(e==r)return 1;if(l=e,m=a(e+1,O),c=a(l+1,O),v=y[c],0===v)return 1;for(b=f(Y[e],Y[m]),l=c;l!=r;l=c){if(c=a(l+1,O),u=a(l+2,O),y[c]!=v)return 1;if(o(h("cprod",Y[e],Y[m],Y[c],Y[u]))!=v)return 1;if(h("iprod1",Y[e],Y[m],Y[c],Y[u])<b*f(Y[c],Y[u])*-.999847695156)return 1}if(z=R.c[3*a(e,O)+2],S=Y[a(e+1,O)],k=Y[a(r,O)],j=R.c[3*a(r,O)+2],w=s[r]-s[e],w-=h("dpara",Y[0],R.c[3*e+2],R.c[3*r+2])/2,e>=r&&(w+=s[O]),C=h("dpara",z,S,k),I=h("dpara",z,S,j),L=h("dpara",z,k,j),X=C+L-I,I==C)return 1;if(H=L/(L-X),F=I/(I-C),$=I*H/2,0===$)return 1;for(q=w/$,g=2-Math.sqrt(4-q/.3),n.c[0]=x(H*g,z,S),n.c[1]=x(F*g,j,k),n.alpha=g,n.t=H,n.s=F,S={x:n.c[0].x,y:n.c[0].y},k={x:n.c[1].x,y:n.c[1].y},n.pen=0,l=a(e+1,O);l!=r;l=c){if(c=a(l+1,O),H=d(z,S,k,j,Y[l],Y[c]),H<-.5)return 1;if(D=p(H,z,S,k,j),b=f(Y[l],Y[c]),0===b)return 1;if(A=h("dpara",Y[l],Y[c],D)/b,Math.abs(A)>i)return 1;if(h("iprod",Y[l],Y[c],D)<0||h("iprod",Y[c],Y[l],D)<0)return 1;n.pen+=A*A}for(l=e;l!=r;l=c){if(c=a(l+1,O),H=d(z,S,k,j,R.c[3*l+2],R.c[3*c+2]),H<-.5)return 1;if(D=p(H,z,S,k,j),b=f(R.c[3*l+2],R.c[3*c+2]),0===b)return 1;if(A=h("dpara",R.c[3*l+2],R.c[3*c+2],D)/b,M=h("dpara",R.c[3*l+2],R.c[3*c+2],Y[c])/b,M*=.75*R.alpha[c],M<0&&(A=-A,M=-M),A<M-i)return 1;A<M&&(n.pen+=(A-M)*(A-M))}return 0}let n,y,s,l,c,u,v,m,w,g,b,A=t.curve,z=A.n,S=A.vertex,k=new Array(z+1),j=new Array(z+1),D=new Array(z+1),$=new Array(z+1),q=new e,C=new Array(z),I=new Array(z+1);for(y=0;y<z;y++)"curve"==A.tag[y]?C[y]=o(h("dpara",S[a(y-1,z)],S[y],S[a(y+1,z)])):C[y]=0;for(v=0,I[0]=0,c=A.vertex[0],y=0;y<z;y++)u=a(y+1,z),"curve"==A.tag[u]&&(m=A.alpha[u],v+=.3*m*(4-m)*h("dpara",A.c[3*y+2],S[u],A.c[3*u+2])/2,v+=h("dpara",c,A.c[3*y+2],A.c[3*u+2])/2),I[y+1]=v;for(k[0]=-1,j[0]=0,D[0]=0,s=1;s<=z;s++)for(k[s]=s-1,j[s]=j[s-1],D[s]=D[s-1]+1,y=s-2;y>=0&&(l=r(t,y,a(s,z),q,i,C,I),!l);y--)(D[s]>D[y]+1||D[s]==D[y]+1&&j[s]>j[y]+q.pen)&&(k[s]=y,j[s]=j[y]+q.pen,D[s]=D[y]+1,$[s]=q,q=new e);for(n=D[z],w=new M(n),g=new Array(n),b=new Array(n),s=z,y=n-1;y>=0;y--)k[s]==s-1?(w.tag[y]=A.tag[a(s,z)],w.c[3*y+0]=A.c[3*a(s,z)+0],w.c[3*y+1]=A.c[3*a(s,z)+1],w.c[3*y+2]=A.c[3*a(s,z)+2],w.vertex[y]=A.vertex[a(s,z)],w.alpha[y]=A.alpha[a(s,z)],w.alpha0[y]=A.alpha0[a(s,z)],w.beta[y]=A.beta[a(s,z)],g[y]=b[y]=1):(w.tag[y]="curve",w.c[3*y+0]=$[s].c[0],w.c[3*y+1]=$[s].c[1],w.c[3*y+2]=A.c[3*a(s,z)+2],w.vertex[y]=x($[s].s,A.c[3*a(s,z)+2],S[a(s,z)]),w.alpha[y]=$[s].alpha,w.alpha0[y]=$[s].alpha,g[y]=$[s].s,b[y]=$[s].t),s=k[s];for(y=0;y<n;y++)u=a(y+1,n),w.beta[y]=g[y]/(g[y]+b[u]);w.alphacurve=1,t.curve=w}t.prototype.at=function(t,e){return this.data[3*t+e]};for(let t=0;t<y.length;t++){let e=y[t];v(e),m(e),w(e),g(e),"-"===e.sign&&b(e),A(e),r&&z(e)}}(),y}function D(t={}){Object.assign(this,t)}async function $(t,{turnpolicy:e="majority",turdsize:a=1,optcurve:r=!0,alphamax:n=1,opttolerance:i=1,minSize:y=1e3,maxSize:s=5e3,scale:l=1,addDimensions:o=!0,toRelative:c=!0,toShorthands:x=!0,decimals:u=3}={}){let h=await b(t,{minSize:y,maxSize:s,scale:l}),{bmp:f,scaleAdjust:p,width:d,height:v}=h;console.log(y,s,h);let m=j(f,{turnpolicy:e,turdsize:a,optcurve:r,alphamax:n,opttolerance:i,scaleAdjust:p,minSize:y,maxSize:s});l=1/p,console.log(c,x,u);let w=function(t=[],e=1){let a=t.length,r=[];for(let n=0;n<a;n++){let a,i=t[n].curve,y=i.n;r.push({type:"M",values:[i.c[3*(y-1)+2].x*e,i.c[3*(y-1)+2].y*e]});for(let t=0;t<y;t++){let n=i.tag[t];"curve"===n?a=[{type:"C",values:[i.c[3*t].x*e,i.c[3*t].y*e,i.c[3*t+1].x*e,i.c[3*t+1].y*e,i.c[3*t+2].x*e,i.c[3*t+2].y*e]}]:"corner"===n&&(a=[{type:"L",values:[i.c[3*t+1].x*e,i.c[3*t+1].y*e]},{type:"L",values:[i.c[3*t+2].x*e,i.c[3*t+2].y*e]}]),r.push(...a)}r.push({type:"Z",values:[]})}return r}(m,l),g=JSON.parse(JSON.stringify(w)),A=function(t,e,a,{toRelative:r=!0,toShorthands:n=!0,decimals:i=3,addDimensions:y=!1}={}){e=Math.ceil(e),a=Math.ceil(a),(r||n||-1!=i)&&(t=S(t,{toRelative:r,toShorthands:n,decimals:i}));let s=function(t,e=-1,a=!1){"l"===t[1].type&&a&&(t[0].type="m");let r=`${t[0].type}${t[0].values.join(" ")}`;for(let n=1;n<t.length;n++){let i=t[n-1],y=t[n],s=i.type===y.type&&a||("m"===i.type&&"l"===y.type||"M"===i.type&&"l"===y.type||"M"===i.type&&"L"===y.type)&&a?" ":y.type;y.values.length&&e>-1&&(y.values=y.values.map(t=>+t.toFixed(e))),r+=`${s}${y.values.join(" ")}`}return a&&(r=r.replaceAll(" 0."," .").replaceAll(" -","-").replaceAll("-0.","-.").replace(/\s+([mlcsqtahvz])/gi,"$1").replaceAll("Z","z")),r}(t,i);return{svg:`<svg viewBox="0 0 ${e} ${a}" ${y?`width="${e}" height="${a}" `:""}xmlns="http://www.w3.org/2000/svg"><path d="${s}"/></svg>`,d:s}}(w,d,v,{addDimensions:o,toRelative:c,toShorthands:x,decimals:u});return A.pathData=w,A.scaleAdjust=p,A.pathDataNorm=g,console.log("!!!data",A,w),new D(A)}g.prototype.at=function(t,e){return t>=0&&t<this.w&&e>=0&&e<this.h&&1===this.data[this.w*e+t]},g.prototype.index=function(t){let e={x:0,y:Math.floor(t/this.w)};return e.x=t-e.y*this.w,e},g.prototype.flip=function(t,e){this.at(t,e)?this.data[this.w*e+t]=0:this.data[this.w*e+t]=1},g.prototype.copy=function(){let t,e=new g(this.w,this.h);for(t=0;t<this.size;t++)e.data[t]=this.data[t];return e},D.prototype.getSVG=function(){return this.svg},D.prototype.getPathData=function(){return this.pathData},D.prototype.getD=function(){return this.d},"undefined"!=typeof window&&(window.Potrace=$);export{w as PI,$ as Potrace,D as PotraceObj,t as abs,e as acos,a as asin,r as atan,n as atan2,i as ceil,y as cos,s as exp,l as floor,c as hypot,o as log,x as max,u as min,h as pow,f as random,p as round,d as sin,v as sqrt,m as tan};
