!function(t){"use strict";const{abs:e,acos:r,asin:n,atan:a,atan2:i,ceil:l,cos:y,exp:o,floor:s,log:x,hypot:c,max:u,min:h,pow:f,random:p,round:g,sin:d,sqrt:v,tan:w,PI:m}=Math;async function b(t,{minSize:e=1e3,maxSize:r=5e3,filter:n="",scale:a=1,stripWhite:i=!0,crop:l=!0,canvas:y=null,brightness:o=1,contrast:s=1,invert:x=!1,blur:c=0}={}){let u,h,f=function(t){if(t instanceof HTMLImageElement)return"img";if(t instanceof SVGElement)return"svg";if(t instanceof HTMLCanvasElement)return"canvas";if(t instanceof File)return"file";if(t instanceof ArrayBuffer)return"buffer";if(t instanceof Blob)return"blob";if(Array.isArray(t))return"array";if("string"==typeof t){let e=/^(file:|https?:\/\/|\/|\.\/|\.\.\/)/.test(t),r=t.startsWith("data:image");return e||r?"url":"string"}let e=typeof t,r=t.constructor.name;return(r||e).toLowerCase()}(t),p={minSize:e,maxSize:r,filter:n,scale:a,brightness:o,contrast:s,invert:x,blur:c,canvas:y};if("img"===f)h=t.src,u=await A(h,p);else if("blob"===f||"file"===f)h=await URL.createObjectURL(t),u=await A(h,p);else if("url"===f)h=t,console.log("is URL",t),u=await A(h,p);else if("svg"===f)h=await z(t),u=await A(h,p);else if("canvas"===f){let e=t.getContext("2d"),r=`grayscale(1) invert(${x=x?"1":"0"}) blur(${c}px) brightness(${o}) contrast(${s})`;e.filter=r;let n=await e.getImageData(0,0,t.width,t.height);u={imgData:n,width:n.width,height:n.height,scaleAdjust:1}}let{imgData:g,scaleAdjust:d,width:v,height:w}=u,m={x:0,y:0,width:0,height:0};l&&(m=function(t,e=!0,r=!0,n=!1,a=null){let[i,l]=[t.width,t.height];if(!i&&!l)throw new Error("No width or height specified");let y,o=[],s={x:0,y:0,width:i,height:l},x=new Uint32Array(t.data.buffer),c=0,u="";const h=(t,e,r)=>{let n=V(r/t);return{x:r-n*t,y:n}},f=(t=0,e=!1,r=null)=>{if(n&&r){c++;let t=h(i,0,r);u+=`<rect x="${t.x}" y="${t.y}" transform="scale(1)" transform-origin="center" width="1" height="1" fill="rgba(0,255,255,0.25)" stroke="none" />`}return e?t<4294867295:t>0};let p=0,g=0,d=0,v=0,w=i,m=l,b=0,A=i*l-1,[S,z,C,$]=[1,1,1,1];if(r){let t=V(i/2),r=V(l/2),a=[0,l*i-1,i-1,l*i-i,t,l*i-t-1,r*i-1,r*i];for(let t=0;t<a.length;t++){let r=a[t];if(!(S||$||z||C))break;f(x[r],e,r)&&(0===t?(S=0,z=0):1===t?($=0,C=0):2===t?($=0,z=0):3===t?(S=0,z=0):4===t?S=0:5===t?$=0:6===t?C=0:7===t&&(z=0))}if(n&&console.log("corner mid check",c,"cropTop",S,"cropLeft",z,"cropRight",C,"cropBottom",$),!(S||z||C||$))return n&&console.log("image cannot be cropped â€“ opaque pixels in corners",c,"cropTop",S,"cropLeft",z,"cropRight",C,"cropBottom",$),s}for(g=0;g<l;g++){for(p=0;p<i&&(!S||!f(x[b],e,b)||(d=g,S=0,o.push(p),$))&&(!$||!f(x[A],e,A)||(m=l-g,$=0,y=h(i,0,A),o.push(y.x),S));p++)b++,A--;if(!S&&!$)break;if(g+2>=l-g&&!d)return n&&(console.log("image is empty",g,c,i*l),a.insertAdjacentHTML("beforeend",u)),s}for(p=0;p<i;p++)for(b=(d+1)*i+p,A=d*i+(i-p-1),g=d;g<m-1&&(!z||!f(x[b],e,b)||(v=p,z=0,C))&&(!C||!f(x[A],e,A)||(w=i-p,C=0,z));g++)b+=i,A+=i;return v=H(...o,v),w=P(...o,w),s.x=v,s.y=d,s.width=w-v,s.height=m-d,n&&(console.log(c,i*l,"skipped:",i*l-c,o),a.insertAdjacentHTML("beforeend",u)),s}(g,i),v=B(m.width/d),w=B(m.height/d),u.width=v,u.height=w);let b=function(t,e=0,r=0,n=0,a=0){let{data:i,width:l,height:y}=t;n=n||l,a=a||y;let o=new C(n,a),s=4*l,x=0;for(let t=r;t<r+a;t++){let r=0,a=t*s;for(let t=e;t<e+n;t++){let e=i[a+4*t],l=x*n+r;o.data[l]=e<127?1:0,r++}x++}return o}(g,m.x,m.y,m.width,m.height);return{bmp:b,scaleAdjust:d,width:v,height:w}}async function A(t="",{minSize:e=1e3,maxSize:r=5e3,scale:n=1,brightness:a=1,contrast:i=1,invert:l=0,blur:y=0,canvas:o=null}={}){let s,x,c,u,h=1,f=0;e*=n,r*=n,o||((o=document.getElementById("canvasPot"))||(o=document.createElement("canvas")),o.id="canvasPot",document.body.append(o));let p,g=o.getContext("2d",{alpha:!1,willReadFrequently:!0}),d=await fetch(t);if(d.ok){let n=await d.blob(),{type:v}=n;"image/svg+xml"!==v?(p=!0,s=await createImageBitmap(n),[x,c]=[s.width,s.height]):(s=new Image,s.src=t,s.crossOrigin="anonymous",await s.decode(),[x,c]=[s.naturalWidth,s.naturalHeight]),f=H(x,c),h=!p&&(f<e||f>r)?e/f:1,x*=h,c*=h,o.width=x,o.height=c,g.fillStyle="white",g.fillRect(0,0,x,c);let w=`grayscale(1) invert(${l=l?"1":"0"}) blur(${y}px) brightness(${a}) contrast(${i})`;g.filter=w,g.drawImage(s,0,0,x,c),u=g.getImageData(0,0,x,c)}let{width:v,height:w}=u;return v=B(v/h),w=B(w/h),{imgData:u,scaleAdjust:h,width:v,height:w}}async function S(t,{minSize:e=1e3,maxSize:r=5e3,filter:n="",scale:a=1,canvas:i=null}={}){i||(i=document.createElement("canvas"));let l=await z(t),y=new Image;y.src=l,y.crossOrigin="anonymous",await y.decode();let[o,s]=[y.naturalWidth,y.naturalHeight],x=H(o,s),c=x<e||x>r?e/x:1,u=o*c,h=s*c;i.width=u,i.height=h;let f=i.getContext("2d");return f.fillStyle="white",f.fillRect(0,0,u,h),n&&(f.filter=n),f.drawImage(y,0,0,u,h),URL.revokeObjectURL(l),i}async function z(t){const e=t.cloneNode(!0);if(document.body.append(e),!e.hasAttribute("width")&&!e.hasAttribute("height")){let r=e.hasAttribute("viewBox")?{x:0,y:0,width:300,height:150}:t.getBBox(),n=t.viewBox.baseVal.width?e.viewBox.baseVal.width:t.width.baseVal.value?t.width.baseVal.value:r.width,a=t.viewBox.baseVal.height?e.viewBox.baseVal.height:t.height.baseVal.value?t.height.baseVal.value:r.height;e.setAttribute("width",n),e.setAttribute("height",a)}let r=(new XMLSerializer).serializeToString(e),n=new Blob([r],{type:"image/svg+xml"}),a=URL.createObjectURL(n);return e.remove(),a}function C(t,e){this.w=t,this.h=e,this.size=t*e,this.arraybuffer=new ArrayBuffer(this.size),this.data=new Int8Array(this.arraybuffer)}function $(){this.area=0,this.len=0,this.curve={},this.pt=[],this.minX=1e5,this.minY=1e5,this.maxX=-1,this.maxY=-1}function k(t){this.n=t,this.tag=new Array(t),this.c=new Array(3*t),this.alphaCurve=0,this.vertex=new Array(t),this.alpha=new Array(t),this.alpha0=new Array(t),this.beta=new Array(t)}C.prototype.at=function(t,e){return t>=0&&t<this.w&&e>=0&&e<this.h&&1===this.data[this.w*e+t]},C.prototype.index=function(t){let e={x:0,y:V(t/this.w)};return e.x=t-e.y*this.w,e},C.prototype.flip=function(t,e){this.at(t,e)?this.data[this.w*e+t]=0:this.data[this.w*e+t]=1},C.prototype.copy=function(){let t,e=new C(this.w,this.h);for(t=0;t<this.size;t++)e.data[t]=this.data[t];return e};const{abs:L,acos:j,asin:D,atan:E,atan2:R,ceil:B,cos:O,exp:M,floor:V,log:I,max:P,min:H,pow:N,random:U,round:F,sin:T,sqrt:X,tan:q,PI:Q}=Math;function J(t,e,r=!1){let n=R(e.y-t.y,e.x-t.x);return r&&n<0&&(n+=2*Q),n}function Y(t,e,r,n=!1){const a=(t,e,r)=>t>=e&&t<=r||t<=e&&t>=r;let i=!1;if((!n||!r.bottom)&&(r.left>t.x||r.top>t.y||r.bottom<t.y||r.right<t.x))return!1;for(let r=e.length-1,n=0;n<e.length;r=n,n++){const l=e[r],y=e[n];if(t.x==l.x&&t.y==l.y||t.x==y.x&&t.y==y.y)return!0;if(l.y==y.y&&t.y==l.y&&a(t.x,l.x,y.x))return!0;if(a(t.y,l.y,y.y)){if(t.y==l.y&&y.y>=l.y||t.y==y.y&&l.y>=y.y)continue;const e=(l.x-t.x)*(y.y-t.y)-(y.x-t.x)*(l.y-t.y);if(0==e)return!0;l.y<y.y==e>0&&(i=!i)}}return!!i}function W(t,e,r,n=!1){let a={x:(e.x-t.x)*r+t.x,y:(e.y-t.y)*r+t.y};return n&&(a.angle=J(t,e),a.angle<0&&(a.angle+=2*Q)),a}function Z(t,e=.5,r=!1,n=!1){let a;return a=t.length>2?((t,e,r=!1)=>{let a=4===t.length,i=t[0],l=t[1],y=a?t[2]:t[1],o=t[t.length-1],s={x:0,y:0};if(r||n){let t,r,x,c,u,h=i.x===l.x&&i.y===l.y,f=o.x===y.x&&o.y===y.y;0!==e||h?1!==e||f?(h&&(e+=1e-7),f&&(e-=1e-7),t=W(i,l,e),a?(r=W(l,y,e),x=W(y,o,e),c=W(t,r,e),u=W(r,x,e),s=W(c,u,e),s.angle=J(c,u),n&&(s.cpts=[r,x,c,u])):(r=W(i,l,e),x=W(l,o,e),s=W(r,x,e),s.angle=J(r,x),n&&(s.cpts=[r,x]))):(s.x=o.x,s.y=o.y,s.angle=J(y,o)):(s.x=i.x,s.y=i.y,s.angle=J(i,l))}else{let t=1-e;s=a?{x:t**3*i.x+3*t**2*e*l.x+3*t*e**2*y.x+e**3*o.x,y:t**3*i.y+3*t**2*e*l.y+3*t*e**2*y.y+e**3*o.y}:{x:t*t*i.x+2*t*e*l.x+e**2*o.x,y:t*t*i.y+2*t*e*l.y+e**2*o.y}}return s})(t,e,r):W(t[0],t[1],e,r),r&&a.angle<0&&(a.angle+=2*Q),a}function G(t){let e=[],r={x:t[0].values[0],y:t[0].values[1]};return t.forEach(t=>{let{type:n,values:a}=t;if(a.length){let t=a.length>1?{x:a[a.length-2],y:a[a.length-1]}:"V"===n?{x:r.x,y:a[0]}:{x:a[0],y:r.y};e.push(t),r=t}}),e}function K(t){return 4===t.length?function(t,e,r,n){let[a,i,l,y,o,s,x,c]=[t.x,t.y,e.x,e.y,r.x,r.y,n.x,n.y],u=H(t.y,n.y),h=H(t.x,n.x),f=P(t.x,n.x),p=P(t.y,n.y);if(e.y>=u&&e.y<=p&&r.y>=u&&r.y<=p&&e.x>=h&&e.x<=f&&r.x>=h&&r.x<=f)return[];for(var g,d,v,w,m,b,A,S,z=[],C=0;C<2;++C)if(0==C?(d=6*a-12*l+6*o,g=-3*a+9*l-9*o+3*x,v=3*l-3*a):(d=6*i-12*y+6*s,g=-3*i+9*y-9*s+3*c,v=3*y-3*i),L(g)<1e-12){if(L(d)<1e-12)continue;0<(w=-v/d)&&w<1&&z.push(w)}else(A=d*d-4*v*g)<0?L(A)<1e-12&&0<(w=-d/(2*g))&&w<1&&z.push(w):(0<(m=(-d+(S=X(A)))/(2*g))&&m<1&&z.push(m),0<(b=(-d-S)/(2*g))&&b<1&&z.push(b));var $=z.length;for(;$--;)w=z[$];return z}(t[0],t[1],t[2],t[3]):function(t,e,r){let n,a,i,l=H(t.y,r.y),y=H(t.x,r.x),o=P(t.x,r.x),s=P(t.y,r.y);if(e.y>=l&&e.y<=s&&e.x>=y&&e.x<=o)return[];let[x,c,u,h,f,p]=[t.x,t.y,e.x,e.y,r.x,r.y],g=[];for(var d=0;d<2;++d)n=0==d?x-2*u+f:c-2*h+p,a=0==d?-2*x+2*u:-2*c+2*h,L(n)>1e-12&&(i=-a/(2*n),i>0&&i<1&&g.push(i));return g}(t[0],t[1],t[2])}function _(t,e){const r=(t,e,r,n,a,i)=>{var l=l(i),y=y(i),o=n*l(t),s=a*y(t);return{x:e+l*o-y*s,y:r+y*o+l*s}};let n,a,i,l,y,o=function(t,e,r,n,a,i,l,y,o){const s=(t,e,r,n)=>R(n-e,r-t);let x={cx:0,cy:0,rx:r=L(r),ry:n=L(n),startAngle:0,endAngle:0,deltaAngle:0,clockwise:l,xAxisRotation:a,largeArc:i,sweep:l};if(0==r||0==n)throw Error("rx and ry can not be 0");if(r===n){let r=L(y-t),n=L(o-e),a=r,i=H(t,y),s=H(e,o),c=.5*Q;if(0===r&&n||0===n&&r)return a=0===r&&n?n/2:r/2,x.rx=a,x.ry=a,0===r&&n?(x.cx=t,x.cy=s+n/2,x.startAngle=e>o?c:-c,x.endAngle=e>o?-c:c,x.deltaAngle=l?Q:-Q):0===n&&r&&(x.cx=i+r/2,x.cy=e,x.startAngle=t>y?Q:0,x.endAngle=t>y?-Q:Q,x.deltaAngle=l?Q:-Q),x}let c,u,h=r===n?0:a*Q/180,f=h?T(h):0,p=h?O(h):1,g=(t-y)/2,d=(e-o)/2,v=(t+y)/2,w=(e+o)/2,m=h?p*g+f*d:g,b=h?p*d-f*g:d,A=m*m/(r*r)+b*b/(n*n);A>1&&(r*=X(A),n*=X(A),x.rx=r,x.ry=n);let S=r*n,z=r*b,C=n*m,$=z**2+C**2;if(!$)throw Error("start point can not be same as end point");let k=X(L((S*S-$)/$));i==l&&(k=-k);let j=k*z/n,D=-k*C/r;c=h?p*j-f*D+v:v+j,u=h?f*j+p*D+w:w+D,x.cy=u,x.cx=c;let E=s(c,u,t,e),B=s(c,u,y,o);!l&&B>E&&(B-=2*Q),l&&E>B&&(B=B<=0?B+2*Q:B);let M=B-E;return x.startAngle=E,x.endAngle=B,x.deltaAngle=M,x}(t.x,t.y,e[0],e[1],e[2],e[3],e[4],e[5],e[6]),{rx:s,ry:x,cx:c,cy:u,endAngle:h,deltaAngle:f}=o,p=e[2],g={x:e[5],y:e[6]},d=[g],v=p*Q/180,w=w(v);y=R(-x*w,s);let m=y,b=y+Q,A=R(x,s*w),S=A+Q,z=[t.x,g.x],C=[t.y,g.y],$=H(...z),k=P(...z),j=H(...C),D=P(...C),E=r(h-.001*f,c,u,s,x,v),B=r(h-.999*f,c,u,s,x,v);return(E.x>k||B.x>k)&&(n=r(m,c,u,s,x,v),d.push(n)),(E.x<$||B.x<$)&&(a=r(b,c,u,s,x,v),d.push(a)),(E.y<j||B.y<j)&&(l=r(S,c,u,s,x,v),d.push(l)),(E.y>D||B.y>D)&&(i=r(A,c,u,s,x,v),d.push(i)),d}function tt(t){let e=[];try{t.map((t,e)=>"m"===t.type.toLowerCase()?e:-1).filter(t=>-1!==t)}catch{console.log("catch",t)}let r=t.map((t,e)=>"m"===t.type.toLowerCase()?e:-1).filter(t=>-1!==t);return 1===r.length?[t]:(r.forEach((n,a)=>{e.push(t.slice(n,r[a+1]))}),e)}function et(t,e){let r,n,a,i,l,y,o=[],s=[],x=t[0],c=t[1],u=t[t.length-2],h=t[t.length-1];return 4===t.length?(r=Z([x,c],e),n=Z([c,u],e),a=Z([u,h],e),i=Z([r,n],e),l=Z([n,a],e),y=Z([i,l],e),o.push({x:x.x,y:x.y},{x:r.x,y:r.y},{x:i.x,y:i.y},{x:y.x,y:y.y}),s.push({x:y.x,y:y.y},{x:l.x,y:l.y},{x:a.x,y:a.y},{x:h.x,y:h.y})):3===t.length?(n=Z([x,c],e),a=Z([c,h],e),y=Z([n,a],e),o.push({x:x.x,y:x.y},{x:n.x,y:n.y},{x:y.x,y:y.y}),s.push({x:y.x,y:y.y},{x:a.x,y:a.y},{x:h.x,y:h.y})):2===t.length&&(n=Z([x,h],e),o.push({x:x.x,y:x.y},{x:n.x,y:n.y}),s.push({x:n.x,y:n.y},{x:h.x,y:h.y})),[o,s]}function rt(t,e){let r=[],n=6===e.length?"C":"Q",a={x:e[0],y:e[1]},i="C"===n?{x:e[2],y:e[3]}:a,l={x:e[4],y:e[5]},y=P(l.x,t.x),o=H(l.x,t.x),s=P(l.y,t.y),x=H(l.y,t.y),c=0;if(a.x<o||a.x>y||a.y<x||a.y>s||i.x<o||i.x>y||i.y<x||i.y>s){let y=K("C"===n?[t,a,i,l]:[t,a,l]).sort();if(y.length){let n=function(t,e,r,n=!0){let a=[];if(!r.length)return!1;let i,l,y,o=e.length,s={x:e[o-2],y:e[o-1]};2===e.length?y=[t,s]:4===e.length?(i={x:e[0],y:e[1]},y=[t,i,s]):6===e.length&&(i={x:e[0],y:e[1]},l={x:e[2],y:e[3]},y=[t,i,l,s]);if(r.length)if(1===r.length){let t=et(y,r[0]),e=t[0],n=t[1];a.push(e,n)}else{let t=r[0],e=et(y,t),n=e[0];a.push(n),y=e[1];for(let e=1;e<r.length;e++){t=r[e-1];let n=et(y,(r[e]-t)/(1-t));a.push(n[0]),e===r.length-1&&a.push(n[n.length-1]),y=n[1]}}if(n){let t,e,r=[];return a.forEach(n=>{t={type:"",values:[]},n.shift(),e=n.map(t=>Object.values(t)).flat(),t.values=e,3===n.length?t.type="C":2===n.length?t.type="Q":1===n.length&&(t.type="L"),r.push(t)}),r}return a}(t,e,y);r.push(...n),c+=n.length}else r.push({type:n,values:e})}else r.push({type:n,values:e});return{pathData:r,count:c}}function nt(t){let e=[t[0]],r={x:t[0].values[0],y:t[0].values[1]},n={x:t[0].values[0],y:t[0].values[1]},a=t.length;for(let i=1;a&&i<a;i++){let a=t[i],{type:l,values:y}=a,o=y.slice(-2);if(o[0],o[1],"C"!==l&&"Q"!==l)e.push(a);else if("C"===l||"Q"===l){let t=rt(r,y).pathData;t.length?e.push(...t):e.push(a)}r={x:o[0],y:o[1]},"z"===l.toLowerCase()?r=n:"M"===l&&(n={x:o[0],y:o[1]})}return e}function at(t,e){let[r,n,a,i,l,y]=[t.x,t.y,t.width,t.height,t.x+t.width,t.y+t.height],[o,s,x,c,u,h]=[e.x,e.y,e.width,e.height,e.x+e.width,e.y+e.height],f=!1;return a*i!=x*c&&a*i>x*c&&r<o&&l>u&&n<s&&y>h&&(f=!0),f}function it(t){let e=1/0,r=-1/0,n=1/0,a=-1/0;const i=t=>{t.x<e&&(e=t.x),t.x>r&&(r=t.x),t.y<n&&(n=t.y),t.y>a&&(a=t.y)};for(let e=0;e<t.length;e++){let r=t[e],{type:n,values:a}=r,l=a.length,y=(t[e-1]?t[e-1]:t[e]).values,o=y.length;if(l){let t={x:y[o-2],y:y[o-1]},e={x:a[l-2],y:a[l-1]};if(i(e),"C"===n||"Q"===n){let r={x:a[0],y:a[1]},l="C"===n?{x:a[2],y:a[3]}:r,y="C"===n?[t,r,l,e]:[t,r,e];K(y).forEach(t=>{let e=Z(y,t);i(e)})}else if("A"===n){_(t,a).forEach(t=>{i(t)})}}}return{x:e,y:n,width:r-e,height:a-n}}function lt(t,e=["x","y"]){let r=tt(t);if(1===r.length)return t;let n=[];var a;r.forEach(function(t,e){let r=function(t,e=-1){let r=t.map(t=>t.x),n=t.map(t=>t.y),a=H(...r),i=P(...r),l=H(...n),y=P(...n),o={x:a,left:a,right:i,y:l,top:l,bottom:y,width:i-a,height:y-l};if(e>-1)for(let t in o)o[t]=+o[t].toFixed(e);return o}(G(t)),{x:a,y:i,width:l,height:y}=r;n.push({x:a,y:i,width:l,height:y,index:e})}),n.sort((a=e,function(t,e){return a.map(function(r){var n=1;return"-"===r[0]&&(n=-1,r=r.substring(1)),t[r]>e[r]?n:t[r]<e[r]?-n:0}).reduce(function(t,e){return t||e},0)}));let i=[];return n.forEach(function(t,e){let n=t.index;i.push(...r[n])}),i}function yt(t,e=-1){let r=!("auto"!=e||!t[0].hasOwnProperty("decimals"));for(let n=0,a=t.length;n<a;n++){let a=t[n];(e>-1||r)&&(e=r?a.decimals:e,t[n].values=a.values.map(t=>t?+t.toFixed(e):t))}return t}function ot(t,{toShorthands:e=!0,toRelative:r=!0,decimals:n=3}={}){return n>-1&&n<2&&(t=yt(t,n)),e&&(t=function(t,e=-1,r=!0){let n;if(r){let e=t.map(t=>t.type).join("");n=/[astvqmhlc]/g.test(e)}t=r&&n?function(t,e=-1){return st(t,!1,e)}(t,e):t;let a={type:"M",values:t[0].values};t[0].decimals&&(a.decimals=t[0].decimals);let i,l=[a],y={x:t[0].values[0],y:t[0].values[1]},o=.01;for(let r=1,n=t.length;r<n;r++){let n=t[r],{type:s,values:x}=n,c=x.slice(-2),u=t[r-1],h=u.type;i={x:c[0],y:c[1]};let f,p,g,d,v={x:x[0],y:x[1]},w=L(i.x-y.x),m=L(i.y-y.y),b=(w+m)/2*o;switch(s){case"L":a=0===m||m<b&&w>b?{type:"H",values:[x[0]]}:0===w||m>b&&w<b?{type:"V",values:[x[1]]}:n;break;case"Q":if("Q"!==h){y={x:c[0],y:c[1]},l.push(n);continue}let t={x:u.values[0],y:u.values[1]};d={x:2*y.x-t.x,y:2*y.y-t.y},f=L(v.x-d.x),p=L(v.y-d.y),g=(f+p)/2,a=g<b?{type:"T",values:[i.x,i.y]}:n;break;case"C":let e={x:x[2],y:x[3]};if("C"!==h){l.push(n),y={x:c[0],y:c[1]};continue}let r={x:u.values[2],y:u.values[3]};d={x:2*y.x-r.x,y:2*y.y-r.y},f=L(v.x-d.x),p=L(v.y-d.y),g=(f+p)/2,a=g<b?{type:"S",values:[e.x,e.y,i.x,i.y]}:n;break;default:a={type:s,values:x}}(n.decimals||0===n.decimals)&&(a.decimals=n.decimals),e>-1&&(a.values=a.values.map(t=>+t.toFixed(e))),y={x:c[0],y:c[1]},l.push(a)}return l}(t)),r&&(t=function(t,e=-1){return st(t,!0,e)}(t)),n>-1&&(t=yt(t,n)),t}function st(t,e=!1,r=-1){r>=0&&(t[0].values=t[0].values.map(t=>+t.toFixed(r)));let n=t[0].values,a=n[0],i=n[1],l=a,y=i;for(let n=1,o=t.length;n<o;n++){let o=t[n],{type:s,values:x}=o,c=e?s.toLowerCase():s.toUpperCase();if(s!==c)switch(s=c,o.type=s,s){case"a":case"A":x[5]=e?x[5]-a:x[5]+a,x[6]=e?x[6]-i:x[6]+i;break;case"v":case"V":x[0]=e?x[0]-i:x[0]+i;break;case"h":case"H":x[0]=e?x[0]-a:x[0]+a;break;case"m":case"M":e?(x[0]-=a,x[1]-=i):(x[0]+=a,x[1]+=i),l=e?x[0]+a:x[0],y=e?x[1]+i:x[1];break;default:if(x.length)for(let t=0;t<x.length;t++)x[t]=e?x[t]-(t%2?i:a):x[t]+(t%2?i:a)}let u=x.length;switch(s){case"z":case"Z":a=l,i=y;break;case"h":case"H":a=e?a+x[0]:x[0];break;case"v":case"V":i=e?i+x[0]:x[0];break;case"m":case"M":l=x[u-2]+(e?a:0),y=x[u-1]+(e?i:0);default:a=x[u-2]+(e?a:0),i=x[u-1]+(e?i:0)}r>=0&&(o.values=o.values.map(t=>+t.toFixed(r)))}return t}function xt(t,e=-1,r=!1){"l"===t[1].type&&r&&(t[0].type="m");let n=`${t[0].type}${t[0].values.join(" ")}`;for(let a=1;a<t.length;a++){let i=t[a-1],l=t[a],y=i.type===l.type&&r||("m"===i.type&&"l"===l.type||"M"===i.type&&"l"===l.type||"M"===i.type&&"L"===l.type)&&r?" ":l.type;l.values.length&&e>-1&&(l.values=l.values.map(t=>+t.toFixed(e))),n+=`${y}${l.values.join(" ")}`}return r&&(n=n.replaceAll(" 0."," .").replaceAll(" -","-").replaceAll("-0.","-.").replace(/\s+([mlcsqtahvz])/gi,"$1").replaceAll("Z","z")),n}function ct(t,{turnpolicy:e="majority",turdsize:r=1,optcurve:n=!0,alphamax:a=1,opttolerance:i=1}={}){let l=[];return function(){let n,a=t.copy(),i={x:0,y:0};function y(t){let e=a.w*t.y+t.x;for(;e<a.size&&1!==a.data[e];)e++;return e<a.size&&a.index(e)}function o(t,e){for(let r=2;r<5;r++){let n=0;for(let i=1-r;i<=r-1;i++)n+=a.at(t+i,e+r-1)?1:-1,n+=a.at(t+r-1,e+i-1)?1:-1,n+=a.at(t+i-1,e-r)?1:-1,n+=a.at(t-r,e+i)?1:-1;if(n>0)return 1;if(n<0)return 0}return 0}function s(r){let n,i=new $,l=r.x,y=r.y,s=0,x=1;for(i.sign=t.at(r.x,r.y)?"+":"-";i.pt.push({x:l,y:y}),l>i.maxX&&(i.maxX=l),l<i.minX&&(i.minX=l),y>i.maxY&&(i.maxY=y),y<i.minY&&(i.minY=y),i.len++,l+=s,y+=x,i.area-=l*x,l!==r.x||y!==r.y;){let t=a.at(l+(s+x-1)/2,y+(x-s-1)/2),r=a.at(l+(s-x-1)/2,y+(x+s-1)/2);r&&!t?"right"===e||"black"===e&&"+"===i.sign||"white"===e&&"-"===i.sign||"majority"===e&&o(l,y)||"minority"===e&&!o(l,y)?(n=s,s=-x,x=n):(n=s,s=x,x=-n):r?(n=s,s=-x,x=n):t||(n=s,s=x,x=-n)}return i}function x(t){let e,r,n=t.pt[0].y,i=t.len;for(let l=1;l<i;l++){let i=t.pt[l].x,y=t.pt[l].y;if(y!==n){r=n<y?n:y,e=t.maxX;for(let t=i;t<e;t++)a.flip(t,r);n=y}}}for(;i=y(i);)n=s(i),x(n),n.area>r&&l.push(n)}(),function(){function t(){this.data=[0,0,0,0,0,0,0,0,0]}function e(t,e,r,n,a){this.x=t,this.y=e,this.xy=r,this.x2=n,this.y2=a}function r(t,e){return t>=e?t%e:t>=0?t:e-1-(-1-t)%e}function y(t,e){return t.x*e.y-t.y*e.x}function o(t,e,r){return t<=r?t<=e&&e<r:t<=e||e<r}function s(t){return t>0?1:t<0?-1:0}function x(t,e){let r=new Array(3),n=0;r[0]=e.x,r[1]=e.y,r[2]=1;for(let e=0;e<3;e++)for(let a=0;a<3;a++)n+=r[e]*t.at(e,a)*r[a];return n}function c(t,e,r){return{x:e.x+t*(r.x-e.x),y:e.y+t*(r.y-e.y)}}function u(t,e){let r=function(t,e){return{x:-s(e.y-t.y),y:s(e.x-t.x)}}(t,e);return r.y*(e.x-t.x)-r.x*(e.y-t.y)}function h(t="",e={},r={},n={},a={}){let i,l,y,o;return"cprod"===t||"iprod1"===t?(i=r.x-e.x,y=r.y-e.y,l=a.x-n.x,o=a.y-n.y):(i=r.x-e.x,y=r.y-e.y,l=n.x-e.x,o=n.y-e.y),"cprod"===t||"dpara"===t?i*o-l*y:i*l+y*o}function f(t,e){return X((t.x-e.x)**2+(t.y-e.y)**2)}function p(t,e,r,n,a){let i=1-t;return{x:i*i*i*e.x+i*i*t*3*r.x+t*t*i*3*n.x+t*t*t*a.x,y:i*i*i*e.y+i*i*t*3*r.y+t*t*i*3*n.y+t*t*t*a.y}}function g(t,e,r,n,a,i){let l=h("cprod",t,e,a,i),y=h("cprod",e,r,a,i),o=l-2*y+h("cprod",r,n,a,i),s=-2*l+2*y,x=s*s-4*o*l;if(0===o||x<0)return-1;let c=X(x),u=(-s+c)/(2*o),f=(-s-c)/(2*o);return u>=0&&u<=1?u:f>=0&&f<=1?f:-1}function d(t){t.x0=t.pt[0].x,t.y0=t.pt[0].y,t.sums=[];let r=t.sums;r.push(new e(0,0,0,0,0));for(let n=0;n<t.len;n++){let a=t.pt[n].x-t.x0,i=t.pt[n].y-t.y0;r.push(new e(r[n].x+a,r[n].y+i,r[n].xy+a*i,r[n].x2+a*a,r[n].y2+i*i))}}function v(t){let e,n=t.len,a=t.pt,i=new Array(n),l=new Array(n),x=new Array(4);t.lon=new Array(n);let c,u,h,f,p,g,d,v,w=[{x:0,y:0},{x:0,y:0}],m={x:0,y:0},b={x:0,y:0},A={x:0,y:0},S=0;for(u=n-1;u>=0;u--)a[u].x!=a[S].x&&a[u].y!=a[S].y&&(S=u+1),l[u]=S;for(u=n-1;u>=0;u--){for(x[0]=x[1]=x[2]=x[3]=0,e=(3+3*(a[r(u+1,n)].x-a[u].x)+(a[r(u+1,n)].y-a[u].y))/2,x[e]++,w[0].x=0,w[0].y=0,w[1].x=0,w[1].y=0,S=l[u],f=u;;){if(c=0,e=(3+3*s(a[S].x-a[f].x)+s(a[S].y-a[f].y))/2,x[e]++,x[0]&&x[1]&&x[2]&&x[3]){i[u]=f,c=1;break}if(m.x=a[S].x-a[u].x,m.y=a[S].y-a[u].y,y(w[0],m)<0||y(w[1],m)>0)break;if(L(m.x)<=1&&L(m.y)<=1||(b.x=m.x+(m.y>=0&&(m.y>0||m.x<0)?1:-1),b.y=m.y+(m.x<=0&&(m.x<0||m.y<0)?1:-1),y(w[0],b)>=0&&(w[0].x=b.x,w[0].y=b.y),b.x=m.x+(m.y<=0&&(m.y<0||m.x<0)?1:-1),b.y=m.y+(m.x>=0&&(m.x>0||m.y<0)?1:-1),y(w[1],b)<=0&&(w[1].x=b.x,w[1].y=b.y)),f=S,S=l[f],!o(S,u,f))break}0===c&&(A.x=s(a[S].x-a[f].x),A.y=s(a[S].y-a[f].y),m.x=a[f].x-a[u].x,m.y=a[f].y-a[u].y,p=y(w[0],m),g=y(w[0],A),d=y(w[1],m),v=y(w[1],A),h=1e7,g<0&&(h=V(p/-g)),v>0&&(h=H(h,V(-d/v))),i[u]=r(f+h,n))}for(h=i[n-1],t.lon[n-1]=h,u=n-2;u>=0;u--)o(u+1,i[u],h)&&(h=i[u]),t.lon[u]=h;for(u=n-1;o(r(u+1,n),h,t.lon[u]);u--)t.lon[u]=h}function w(t){function e(t,e,r){let n,a,i,l,y,o,s,x,c,u,h,f,p,g,d=t.len,v=t.pt,w=t.sums,m=0;return r>=d&&(r-=d,m=1),0===m?(n=w[r+1].x-w[e].x,a=w[r+1].y-w[e].y,l=w[r+1].x2-w[e].x2,i=w[r+1].xy-w[e].xy,y=w[r+1].y2-w[e].y2,o=r+1-e):(n=w[r+1].x-w[e].x+w[d].x,a=w[r+1].y-w[e].y+w[d].y,l=w[r+1].x2-w[e].x2+w[d].x2,i=w[r+1].xy-w[e].xy+w[d].xy,y=w[r+1].y2-w[e].y2+w[d].y2,o=r+1-e+d),h=(v[e].x+v[r].x)/2-v[0].x,f=(v[e].y+v[r].y)/2-v[0].y,g=v[r].x-v[e].x,p=-(v[r].y-v[e].y),s=(l-2*n*h)/o+h*h,x=(i-n*f-a*h)/o+h*f,c=(y-2*a*f)/o+f*f,u=p*p*s+2*p*g*x+g*g*c,X(u)}let n,a,i,l,y,o,s,x=t.len,c=new Array(x+1),u=new Array(x+1),h=new Array(x),f=new Array(x+1),p=new Array(x+1),g=new Array(x+1);for(n=0;n<x;n++)s=r(t.lon[r(n-1,x)]-1,x),s==n&&(s=r(n+1,x)),h[n]=s<n?x:s;for(a=1,n=0;n<x;n++)for(;a<=h[n];)f[a]=n,a++;for(n=0,a=0;n<x;a++)p[a]=n,n=h[n];for(p[a]=x,i=a,n=x,a=i;a>0;a--)g[a]=n,n=f[n];for(g[0]=0,c[0]=0,a=1;a<=i;a++)for(n=g[a];n<=p[a];n++){for(o=-1,l=p[a-1];l>=f[n];l--)y=e(t,l,n)+c[l],(o<0||y<o)&&(u[n]=l,o=y);c[n]=o}for(t.m=i,t.po=new Array(i),n=x,a=i-1;n>0;a--)n=u[n],t.po[a]=n}function m(e){function n(t,e,r,n,a){let i,l,y,o,s,x,c,u,h,f,p,g=t.len,d=t.sums,v=0;for(;r>=g;)r-=g,v+=1;for(;e>=g;)e-=g,v-=1;for(;r<0;)r+=g,v-=1;for(;e<0;)e+=g,v+=1;i=d[r+1].x-d[e].x+v*d[g].x,l=d[r+1].y-d[e].y+v*d[g].y,y=d[r+1].x2-d[e].x2+v*d[g].x2,o=d[r+1].xy-d[e].xy+v*d[g].xy,s=d[r+1].y2-d[e].y2+v*d[g].y2,x=r+1-e+v*g,n.x=i/x,n.y=l/x,c=(y-i*i/x)/x,u=(o-i*l/x)/x,h=(s-l*l/x)/x,f=(c+h+X((c-h)*(c-h)+4*u*u))/2,c-=f,h-=f,L(c)>=L(h)?(p=X(c*c+u*u),0!==p&&(a.x=-u/p,a.y=c/p)):(p=X(h*h+u*u),0!==p&&(a.x=-h/p,a.y=u/p)),0===p&&(a.x=a.y=0)}let a,i,l,y,o,s,c,u,h,f,p,g,d,v,w,m=e.m,b=e.po,A=e.len,S=e.pt,z=e.x0,C=e.y0,$=new Array(m),j=new Array(m),D=new Array(m),E=new Array(3),R={x:0,y:0};for(e.curve=new k(m),i=0;i<m;i++)l=b[r(i+1,m)],l=r(l-b[i],A)+b[i],$[i]={x:0,y:0},j[i]={x:0,y:0},n(e,b[i],l,$[i],j[i]);for(i=0;i<m;i++)if(D[i]=new t,a=j[i].x*j[i].x+j[i].y*j[i].y,0===a)for(l=0;l<3;l++)for(y=0;y<3;y++)D[i].data[3*l+y]=0;else for(E[0]=j[i].y,E[1]=-j[i].x,E[2]=-E[1]*$[i].y-E[0]*$[i].x,o=0;o<3;o++)for(y=0;y<3;y++)D[i].data[3*o+y]=E[o]*E[y]/a;for(i=0;i<m;i++){for(s=new t,c={x:0,y:0},R.x=S[b[i]].x-z,R.y=S[b[i]].y-C,l=r(i-1,m),o=0;o<3;o++)for(y=0;y<3;y++)s.data[3*o+y]=D[l].at(o,y)+D[i].at(o,y);for(;;){if(f=s.at(0,0)*s.at(1,1)-s.at(0,1)*s.at(1,0),0!==f){c.x=(-s.at(0,2)*s.at(1,1)+s.at(1,2)*s.at(0,1))/f,c.y=(s.at(0,2)*s.at(1,0)-s.at(1,2)*s.at(0,0))/f;break}for(s.at(0,0)>s.at(1,1)?(E[0]=-s.at(0,1),E[1]=s.at(0,0)):s.at(1,1)?(E[0]=-s.at(1,1),E[1]=s.at(1,0)):(E[0]=1,E[1]=0),a=E[0]*E[0]+E[1]*E[1],E[2]=-E[1]*R.y-E[0]*R.x,o=0;o<3;o++)for(y=0;y<3;y++)s.data[3*o+y]+=E[o]*E[y]/a}if(u=L(c.x-R.x),h=L(c.y-R.y),u<=.5&&h<=.5)e.curve.vertex[i]={x:c.x+z,y:c.y+C};else{if(p=x(s,R),d=R.x,v=R.y,0!==s.at(0,0))for(w=0;w<2;w++)c.y=R.y-.5+w,c.x=-(s.at(0,1)*c.y+s.at(0,2))/s.at(0,0),u=L(c.x-R.x),g=x(s,c),u<=.5&&g<p&&(p=g,d=c.x,v=c.y);if(0!==s.at(1,1))for(w=0;w<2;w++)c.x=R.x-.5+w,c.y=-(s.at(1,0)*c.x+s.at(1,2))/s.at(1,1),h=L(c.y-R.y),g=x(s,c),h<=.5&&g<p&&(p=g,d=c.x,v=c.y);for(o=0;o<2;o++)for(y=0;y<2;y++)c.x=R.x-.5+o,c.y=R.y-.5+y,g=x(s,c),g<p&&(p=g,d=c.x,v=c.y);e.curve.vertex[i]={x:d+z,y:v+C}}}}function b(t){let e,r,n,a=t.curve,i=a.n,l=a.vertex;for(e=0,r=i-1;e<r;e++,r--)n=l[e],l[e]=l[r],l[r]=n}function A(t){let e,n,i,l,y,o,s,x,f,p=t.curve.n,g=t.curve;for(e=0;e<p;e++)n=r(e+1,p),i=r(e+2,p),f=c(.5,g.vertex[i],g.vertex[n]),y=u(g.vertex[e],g.vertex[i]),0!==y?(l=h("dpara",g.vertex[e],g.vertex[n],g.vertex[i])/y,l=L(l),o=l>1?1-1/l:0,o/=.75):o=4/3,g.alpha0[n]=o,o>=a?(g.tag[n]="corner",g.c[3*n+1]=g.vertex[n],g.c[3*n+2]=f):(o<.55?o=.55:o>1&&(o=1),s=c(.5+.5*o,g.vertex[e],g.vertex[n]),x=c(.5+.5*o,g.vertex[i],g.vertex[n]),g.tag[n]="curve",g.c[3*n+0]=s,g.c[3*n+1]=x,g.c[3*n+2]=f),g.alpha[n]=o,g.beta[n]=.5;g.alphacurve=1}function S(t){function e(){this.pen=0,this.c=[{x:0,y:0},{x:0,y:0}],this.t=0,this.s=0,this.alpha=0}function n(t,e,n,a,i,l,y){let o,x,u,d,v,w,m,b,A,S,z,C,$,k,j,D,E,R,B,O,M,V,I,P=t.curve.n,H=t.curve,N=H.vertex;if(e==n)return 1;if(o=e,v=r(e+1,P),x=r(o+1,P),d=l[x],0===d)return 1;for(b=f(N[e],N[v]),o=x;o!=n;o=x){if(x=r(o+1,P),u=r(o+2,P),l[x]!=d)return 1;if(s(h("cprod",N[e],N[v],N[x],N[u]))!=d)return 1;if(h("iprod1",N[e],N[v],N[x],N[u])<b*f(N[x],N[u])*-.999847695156)return 1}if(z=H.c[3*r(e,P)+2],C=N[r(e+1,P)],$=N[r(n,P)],k=H.c[3*r(n,P)+2],w=y[n]-y[e],w-=h("dpara",N[0],H.c[3*e+2],H.c[3*n+2])/2,e>=n&&(w+=y[P]),R=h("dpara",z,C,$),B=h("dpara",z,C,k),O=h("dpara",z,$,k),M=R+O-B,B==R)return 1;if(I=O/(O-M),V=B/(B-R),D=B*I/2,0===D)return 1;for(E=w/D,m=2-X(4-E/.3),a.c[0]=c(I*m,z,C),a.c[1]=c(V*m,k,$),a.alpha=m,a.t=I,a.s=V,C={x:a.c[0].x,y:a.c[0].y},$={x:a.c[1].x,y:a.c[1].y},a.pen=0,o=r(e+1,P);o!=n;o=x){if(x=r(o+1,P),I=g(z,C,$,k,N[o],N[x]),I<-.5)return 1;if(j=p(I,z,C,$,k),b=f(N[o],N[x]),0===b)return 1;if(A=h("dpara",N[o],N[x],j)/b,L(A)>i)return 1;if(h("iprod",N[o],N[x],j)<0||h("iprod",N[x],N[o],j)<0)return 1;a.pen+=A*A}for(o=e;o!=n;o=x){if(x=r(o+1,P),I=g(z,C,$,k,H.c[3*o+2],H.c[3*x+2]),I<-.5)return 1;if(j=p(I,z,C,$,k),b=f(H.c[3*o+2],H.c[3*x+2]),0===b)return 1;if(A=h("dpara",H.c[3*o+2],H.c[3*x+2],j)/b,S=h("dpara",H.c[3*o+2],H.c[3*x+2],N[x])/b,S*=.75*H.alpha[x],S<0&&(A=-A,S=-S),A<S-i)return 1;A<S&&(a.pen+=(A-S)*(A-S))}return 0}let a,l,y,o,x,u,d,v,w,m,b,A=t.curve,S=A.n,z=A.vertex,C=new Array(S+1),$=new Array(S+1),j=new Array(S+1),D=new Array(S+1),E=new e,R=new Array(S),B=new Array(S+1);for(l=0;l<S;l++)"curve"==A.tag[l]?R[l]=s(h("dpara",z[r(l-1,S)],z[l],z[r(l+1,S)])):R[l]=0;for(d=0,B[0]=0,x=A.vertex[0],l=0;l<S;l++)u=r(l+1,S),"curve"==A.tag[u]&&(v=A.alpha[u],d+=.3*v*(4-v)*h("dpara",A.c[3*l+2],z[u],A.c[3*u+2])/2,d+=h("dpara",x,A.c[3*l+2],A.c[3*u+2])/2),B[l+1]=d;for(C[0]=-1,$[0]=0,j[0]=0,y=1;y<=S;y++)for(C[y]=y-1,$[y]=$[y-1],j[y]=j[y-1]+1,l=y-2;l>=0&&(o=n(t,l,r(y,S),E,i,R,B),!o);l--)(j[y]>j[l]+1||j[y]==j[l]+1&&$[y]>$[l]+E.pen)&&(C[y]=l,$[y]=$[l]+E.pen,j[y]=j[l]+1,D[y]=E,E=new e);for(a=j[S],w=new k(a),m=new Array(a),b=new Array(a),y=S,l=a-1;l>=0;l--)C[y]==y-1?(w.tag[l]=A.tag[r(y,S)],w.c[3*l+0]=A.c[3*r(y,S)+0],w.c[3*l+1]=A.c[3*r(y,S)+1],w.c[3*l+2]=A.c[3*r(y,S)+2],w.vertex[l]=A.vertex[r(y,S)],w.alpha[l]=A.alpha[r(y,S)],w.alpha0[l]=A.alpha0[r(y,S)],w.beta[l]=A.beta[r(y,S)],m[l]=b[l]=1):(w.tag[l]="curve",w.c[3*l+0]=D[y].c[0],w.c[3*l+1]=D[y].c[1],w.c[3*l+2]=A.c[3*r(y,S)+2],w.vertex[l]=c(D[y].s,A.c[3*r(y,S)+2],z[r(y,S)]),w.alpha[l]=D[y].alpha,w.alpha0[l]=D[y].alpha,m[l]=D[y].s,b[l]=D[y].t),y=C[y];for(l=0;l<a;l++)u=r(l+1,a),w.beta[l]=m[l]/(m[l]+b[u]);w.alphacurve=1,t.curve=w}t.prototype.at=function(t,e){return this.data[3*t+e]};for(let t=0;t<l.length;t++){let e=l[t];d(e),v(e),w(e),m(e),"-"===e.sign&&b(e),A(e),n&&S(e)}}(),l}function ut(t={}){Object.assign(this,t)}async function ht(t,{turnpolicy:e="majority",turdsize:r=1,optcurve:n=!0,alphamax:a=1,opttolerance:i=1,minSize:l=1e3,maxSize:y=5e3,scale:o=1,brightness:s=1,contrast:x=1,invert:c=0,blur:u=0,crop:h=!0,addDimensions:f=!0,toRelative:p=!0,toShorthands:g=!0,decimals:d=3}={}){let v=await b(t,{minSize:l,maxSize:y,crop:h,scale:o,brightness:s,contrast:x,invert:c,blur:u}),{bmp:w,scaleAdjust:m,width:A,height:S}=v,z=function(t=[],e=1){let r=t.length,n=[];for(let a=0;a<r;a++){let r,i=t[a].curve,l=i.n;n.push({type:"M",values:[i.c[3*(l-1)+2].x*e,i.c[3*(l-1)+2].y*e]});for(let t=0;t<l;t++){let a=i.tag[t];"curve"===a?r=[{type:"C",values:[i.c[3*t].x*e,i.c[3*t].y*e,i.c[3*t+1].x*e,i.c[3*t+1].y*e,i.c[3*t+2].x*e,i.c[3*t+2].y*e]}]:"corner"===a&&(r=[{type:"L",values:[i.c[3*t+1].x*e,i.c[3*t+1].y*e]},{type:"L",values:[i.c[3*t+2].x*e,i.c[3*t+2].y*e]}]),n.push(...r)}n.push({type:"Z",values:[]})}return n}(ct(w,{turnpolicy:e,turdsize:r,optcurve:n,alphamax:a,opttolerance:i,scaleAdjust:m,minSize:l,maxSize:y}),o=1/m);if(!z.length)throw new Error("Couldn't trace image");let C=JSON.parse(JSON.stringify(z)),$=function(t,e,r,{toRelative:n=!0,toShorthands:a=!0,decimals:i=3,addDimensions:l=!1}={}){e=B(e),r=B(r);let y=tt(lt(JSON.parse(JSON.stringify(t)))),o=[],s=y.length;for(let t=0;t<s;t++){let e=y[t],r=nt(JSON.parse(JSON.stringify(e))),n=it(r),a=G(r);o.push({pathData:e,bb:n,poly:a,includes:[]})}for(let t=0,e=o.length;t<e;t++){let r=o[t],{bb:n,poly:a}=r;for(let r=0;r<e;r++){let e=o[r];if(t===r)continue;let[i,l]=[e.bb,e.poly];if(!at(n,i))continue;let y=[{x:i.x+.5*i.width,y:i.y+.5*i.height},l[0],l[V(l.length/2)],l[l.length-1]],s=!1;for(let t=0;t<y.length;t++)if(Y(y[t],a,n,!0)){s=!0;break}s&&o[t].includes.push(r)}}for(let t=0,e=o.length;t<e;t++){let e=o[t],{includes:r}=e;r.forEach(e=>{let r=o[e].pathData;r.length&&(o[t].pathData.push(...r),o[e].pathData=[])})}o=o.filter(t=>t.pathData.length);let x=l?`width="${e}" height="${r}" `:"",c=`<svg viewBox="0 0 ${e} ${r}" ${x}xmlns="http://www.w3.org/2000/svg">`,u=[];o.forEach(t=>{let{pathData:e}=t;try{(n||a||-1!=i)&&(e=ot(e,{toRelative:n,toShorthands:a,decimals:i}));let t=xt(e,i);u.push(t),c+=`<path d="${t}"/>`}catch{console.log("catch",e)}}),c+="</svg>",(n||a||-1!=i)&&(t=ot(t,{toRelative:n,toShorthands:a,decimals:i}));let h=xt(t,i);return{svg:`<svg viewBox="0 0 ${e} ${r}" ${x}xmlns="http://www.w3.org/2000/svg"><path d="${h}"/></svg>`,d:h,svgSplit:c,dArr:u,pathData:t}}(z,A,S,{addDimensions:f,toRelative:p,toShorthands:g,decimals:d});return $.width=A,$.height=S,$.commands=z.length,$.scaleAdjust=m,$.pathDataNorm=C,new ut($)}ut.prototype.getSVG=function(t=!1){return t?this.svgSplit:this.svg},ut.prototype.getPathData=function(){return this.pathData},ut.prototype.getD=function(){return this.d},"undefined"!=typeof window&&(window.PotracePlus=ht,window.svg2Canvas=S),t.PI=m,t.PotraceObj=ut,t.PotracePlus=ht,t.abs=e,t.acos=r,t.asin=n,t.atan=a,t.atan2=i,t.ceil=l,t.cos=y,t.exp=o,t.floor=s,t.hypot=c,t.log=x,t.max=u,t.min=h,t.pow=f,t.random=p,t.round=g,t.sin=d,t.sqrt=v,t.svg2Canvas=S,t.tan=w}(this["potrace-plus"]=this["potrace-plus"]||{});
